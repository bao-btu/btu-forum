(function($){if(typeof window.console!="object"){window.console={}}var names=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];for(var i=0;i<names.length;i++){if(typeof window.console[names[i]]!="function"&&typeof window.console[names[i]]!="object"){window.console[names[i]]=function(){}}}if(!Object.keys){Object.keys=(function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable("toString"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=="object"&&typeof obj!=="function"||obj===null){throw new TypeError("Object.keys called on non-object")}var result=[];for(var prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop)}}if(hasDontEnumBug){for(var i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i])}}}return result}})()}$.ajaxPrefilter("script",function(options){options.cache=true});$.ajaxPrefilter(function(options,originalOptions,jqXHR){if(typeof (options.data)=="undefined"){options.data="securitytoken="+pageData.securitytoken}else{if(typeof FormData!=="undefined"&&options.data instanceof FormData){options.data.append("securitytoken",pageData.securitytoken)}else{var addToken=true;var data=options.data.split("&");$.each(data,function(index,value){if(value.match(/^securitytoken=/)){addToken=false;return false}});if(addToken){options.data+="&securitytoken="+pageData.securitytoken}}}});$.ajaxPrefilter(function(options,originalOptions,jqXHR){(function(){var ajaxBaseurl=vBulletin.getAjaxBaseurl();if((originalOptions.url.indexOf(ajaxBaseurl)==0&&originalOptions.url.substr(ajaxBaseurl.length).indexOf("/ajax/render/")==0)||(originalOptions.url.indexOf(ajaxBaseurl)==0&&originalOptions.url.substr(ajaxBaseurl.length).indexOf("/activity/get")==0)||(originalOptions&&originalOptions.data&&originalOptions.data.isAjaxTemplateRender)){var origSuccessCallback=options.success;options.success=function(){console.log("Intercept AJAX template render calls: Start (URL: {0})".format(options.url));var response=arguments[0];if(!response||typeof response!="object"||$.isEmptyObject(response)){if(typeof origSuccessCallback=="function"){return origSuccessCallback.apply(this,arguments)}return false}if(originalOptions.url.substr(ajaxBaseurl.length).indexOf("/activity/get")==0){arguments[0]=response}else{arguments[0]=response.template}var cssLinks=response.css_links;if(!cssLinks||cssLinks.length==0){console.log("Intercept AJAX template render calls: No CSS");if(typeof origSuccessCallback=="function"){console.log("Intercept AJAX template render calls: Calling original success handler");return origSuccessCallback.apply(this,arguments)}}else{console.log("Intercept AJAX template render calls: Has CSS");var getSheetsFromLink=function(link){var matches=link.match(/sheet=([^&]+)&/);if(matches&&matches[1]){return matches[1].split(",")}return[]};var currSheets=[];$("head link[rel=stylesheet]").each(function(){currSheets=currSheets.concat(getSheetsFromLink($(this).attr("href")))});var newSheets=[];$.each(cssLinks,function(idx,el){newSheets=newSheets.concat(getSheetsFromLink(el))});var currSheetLookup={};$.each(currSheets,function(idx,el){currSheetLookup[el]=1});var addSheets=[];$.each(newSheets,function(idx,el){if(el&&typeof currSheetLookup[el]=="undefined"){addSheets.push(el)}});if(addSheets.length==0){console.log("Intercept AJAX template render calls: Needed CSS is already on the page");if(typeof origSuccessCallback=="function"){console.log("Intercept AJAX template render calls: Calling original success handler");return origSuccessCallback.apply(this,arguments)}}else{var sampleLink=cssLinks.pop(),newLink=sampleLink.replace(/sheet=[^&]+&/,"sheet="+addSheets.join(",")+"&"),thisCopy=this,argumentsCopy=arguments,newLinkUn=$("<div />").append(newLink).text();console.log("Intercept AJAX template render calls: Fetching CSS: {0}".format(newLinkUn));$.get(newLinkUn,{cache:true},function(css){$("head").append($("<link />",{rel:"stylesheet",type:"text/css",href:newLinkUn}))}).then(function(){console.log("Intercept AJAX template render calls: Done. Calling original callback.");window.setTimeout(function(){if(typeof origSuccessCallback=="function"){return origSuccessCallback.apply(thisCopy,argumentsCopy)}},50)})}}}}})()});String.prototype.format=function(){var s=this,i=arguments.length;while(i--){s=s.replace(new RegExp("\\{"+i+"\\}","gm"),arguments[i])}return s};String.prototype.latinise=function(){return this.replace(/[^A-Za-z0-9]/g,function(x){var latin_map={"Ã?":"A","Ä‚":"A","áº®":"A","áº¶":"A","áº°":"A","áº²":"A","áº´":"A","Ç?":"A","Ã‚":"A","áº¤":"A","áº¬":"A","áº¦":"A","áº¨":"A","áºª":"A","Ã„":"A","Çž":"A","È¦":"A","Ç ":"A","áº ":"A","È€":"A","Ã€":"A","áº¢":"A","È‚":"A","Ä€":"A","Ä„":"A","Ã…":"A","Çº":"A","á¸€":"A","Èº":"A","Ãƒ":"A","êœ²":"AA","Ã†":"AE","Ç¼":"AE","Ç¢":"AE","êœ´":"AO","êœ¶":"AU","êœ¸":"AV","êœº":"AV","êœ¼":"AY","á¸‚":"B","á¸„":"B","Æ?":"B","á¸†":"B","Éƒ":"B","Æ‚":"B","Ä†":"C","ÄŒ":"C","Ã‡":"C","á¸ˆ":"C","Äˆ":"C","ÄŠ":"C","Æ‡":"C","È»":"C","ÄŽ":"D","á¸?":"D","á¸’":"D","á¸Š":"D","á¸Œ":"D","ÆŠ":"D","á¸Ž":"D","Ç²":"D","Ç…":"D","Ä?":"D","Æ‹":"D","Ç±":"DZ","Ç„":"DZ","Ã‰":"E","Ä”":"E","Äš":"E","È¨":"E","á¸œ":"E","ÃŠ":"E","áº¾":"E","á»†":"E","á»€":"E","á»‚":"E","á»„":"E","á¸˜":"E","Ã‹":"E","Ä–":"E","áº¸":"E","È„":"E","Ãˆ":"E","áºº":"E","È†":"E","Ä’":"E","á¸–":"E","á¸”":"E","Ä˜":"E","É†":"E","áº¼":"E","á¸š":"E","ê?ª":"ET","á¸ž":"F","Æ‘":"F","Ç´":"G","Äž":"G","Ç¦":"G","Ä¢":"G","Äœ":"G","Ä ":"G","Æ“":"G","á¸ ":"G","Ç¤":"G","á¸ª":"H","Èž":"H","á¸¨":"H","Ä¤":"H","â±§":"H","á¸¦":"H","á¸¢":"H","á¸¤":"H","Ä¦":"H","Ã?":"I","Ä¬":"I","Ç?":"I","ÃŽ":"I","Ã?":"I","á¸®":"I","Ä°":"I","á»Š":"I","Èˆ":"I","ÃŒ":"I","á»ˆ":"I","ÈŠ":"I","Äª":"I","Ä®":"I","Æ—":"I","Ä¨":"I","á¸¬":"I","ê?¹":"D","ê?»":"F","ê?½":"G","êž‚":"R","êž„":"S","êž†":"T","ê?¬":"IS","Ä´":"J","Éˆ":"J","á¸°":"K","Ç¨":"K","Ä¶":"K","â±©":"K","ê?‚":"K","á¸²":"K","Æ˜":"K","á¸´":"K","ê?€":"K","ê?„":"K","Ä¹":"L","È½":"L","Ä½":"L","Ä»":"L","á¸¼":"L","á¸¶":"L","á¸¸":"L","â± ":"L","ê?ˆ":"L","á¸º":"L","Ä¿":"L","â±¢":"L","Çˆ":"L","Å?":"L","Ç‡":"LJ","á¸¾":"M","á¹€":"M","á¹‚":"M","â±®":"M","Åƒ":"N","Å‡":"N","Å…":"N","á¹Š":"N","á¹„":"N","á¹†":"N","Ç¸":"N","Æ?":"N","á¹ˆ":"N","È ":"N","Ç‹":"N","Ã‘":"N","ÇŠ":"NJ","Ã“":"O","ÅŽ":"O","Ç‘":"O","Ã”":"O","á»?":"O","á»˜":"O","á»’":"O","á»”":"O","á»–":"O","Ã–":"O","Èª":"O","È®":"O","È°":"O","á»Œ":"O","Å?":"O","ÈŒ":"O","Ã’":"O","á»Ž":"O","Æ ":"O","á»š":"O","á»¢":"O","á»œ":"O","á»ž":"O","á» ":"O","ÈŽ":"O","ê?Š":"O","ê?Œ":"O","ÅŒ":"O","á¹’":"O","á¹?":"O","ÆŸ":"O","Çª":"O","Ç¬":"O","Ã˜":"O","Ç¾":"O","Ã•":"O","á¹Œ":"O","á¹Ž":"O","È¬":"O","Æ¢":"OI","ê?Ž":"OO","Æ?":"E","Æ†":"O","È¢":"OU","á¹”":"P","á¹–":"P","ê?’":"P","Æ¤":"P","ê?”":"P","â±£":"P","ê??":"P","ê?˜":"Q","ê?–":"Q","Å”":"R","Å˜":"R","Å–":"R","á¹˜":"R","á¹š":"R","á¹œ":"R","È?":"R","È’":"R","á¹ž":"R","ÉŒ":"R","â±¤":"R","êœ¾":"C","ÆŽ":"E","Åš":"S","á¹¤":"S","Å ":"S","á¹¦":"S","Åž":"S","Åœ":"S","È˜":"S","á¹ ":"S","á¹¢":"S","á¹¨":"S","Å¤":"T","Å¢":"T","á¹°":"T","Èš":"T","È¾":"T","á¹ª":"T","á¹¬":"T","Æ¬":"T","á¹®":"T","Æ®":"T","Å¦":"T","â±¯":"A","êž€":"L","Æœ":"M","É…":"V","êœ¨":"TZ","Ãš":"U","Å¬":"U","Ç“":"U","Ã›":"U","á¹¶":"U","Ãœ":"U","Ç—":"U","Ç™":"U","Ç›":"U","Ç•":"U","á¹²":"U","á»¤":"U","Å°":"U","È”":"U","Ã™":"U","á»¦":"U","Æ¯":"U","á»¨":"U","á»°":"U","á»ª":"U","á»¬":"U","á»®":"U","È–":"U","Åª":"U","á¹º":"U","Å²":"U","Å®":"U","Å¨":"U","á¹¸":"U","á¹´":"U","ê?ž":"V","á¹¾":"V","Æ²":"V","á¹¼":"V","ê? ":"VY","áº‚":"W","Å´":"W","áº„":"W","áº†":"W","áºˆ":"W","áº€":"W","â±²":"W","áºŒ":"X","áºŠ":"X","Ã?":"Y","Å¶":"Y","Å¸":"Y","áºŽ":"Y","á»´":"Y","á»²":"Y","Æ³":"Y","á»¶":"Y","á»¾":"Y","È²":"Y","ÉŽ":"Y","á»¸":"Y","Å¹":"Z","Å½":"Z","áº?":"Z","â±«":"Z","Å»":"Z","áº’":"Z","È¤":"Z","áº”":"Z","Æµ":"Z","Ä²":"IJ","Å’":"OE","á´€":"A","á´?":"AE","Ê™":"B","á´ƒ":"B","á´„":"C","á´…":"D","á´‡":"E","êœ°":"F","É¢":"G","Ê›":"G","Êœ":"H","Éª":"I","Ê?":"R","á´Š":"J","á´‹":"K","ÊŸ":"L","á´Œ":"L","á´?":"M","É´":"N","á´?":"O","É¶":"OE","á´?":"O","á´•":"OU","á´˜":"P","Ê€":"R","á´Ž":"N","á´™":"R","êœ±":"S","á´›":"T","â±»":"E","á´š":"R","á´œ":"U","á´ ":"V","á´¡":"W","Ê?":"Y","á´¢":"Z","Ã¡":"a","Äƒ":"a","áº¯":"a","áº·":"a","áº±":"a","áº³":"a","áºµ":"a","ÇŽ":"a","Ã¢":"a","áº¥":"a","áº":"a","áº§":"a","áº©":"a","áº«":"a","Ã¤":"a","ÇŸ":"a","È§":"a","Ç¡":"a","áº¡":"a","È?":"a","Ã ":"a","áº£":"a","Èƒ":"a","Ä?":"a","Ä…":"a","á¶?":"a","áºš":"a","Ã¥":"a","Ç»":"a","á¸?":"a","â±¥":"a","Ã£":"a","êœ³":"aa","Ã¦":"ae","Ç½":"ae","Ç£":"ae","êœµ":"ao","êœ·":"au","êœ¹":"av","êœ»":"av","êœ½":"ay","á¸ƒ":"b","á¸…":"b","É“":"b","á¸‡":"b","áµ¬":"b","á¶€":"b","Æ€":"b","Æƒ":"b","Éµ":"o","Ä‡":"c","Ä?":"c","Ã§":"c","á¸‰":"c","Ä‰":"c","É•":"c","Ä‹":"c","Æˆ":"c","È¼":"c","Ä?":"d","á¸‘":"d","á¸“":"d","È¡":"d","á¸‹":"d","á¸?":"d","É—":"d","á¶‘":"d","á¸?":"d","áµ":"d","á¶?":"d","Ä‘":"d","É–":"d","ÆŒ":"d","Ä±":"i","È·":"j","ÉŸ":"j","Ê„":"j","Ç³":"dz","Ç†":"dz","Ã©":"e","Ä•":"e","Ä›":"e","È©":"e","á¸?":"e","Ãª":"e","áº¿":"e","á»‡":"e","á»?":"e","á»ƒ":"e","á»…":"e","á¸™":"e","Ã«":"e","Ä—":"e","áº¹":"e","È…":"e","Ã¨":"e","áº»":"e","È‡":"e","Ä“":"e","á¸—":"e","á¸•":"e","â±¸":"e","Ä™":"e","á¶’":"e","É‡":"e","áº½":"e","á¸›":"e","ê?«":"et","á¸Ÿ":"f","Æ’":"f","áµ®":"f","á¶‚":"f","Çµ":"g","ÄŸ":"g","Ç§":"g","Ä£":"g","Ä?":"g","Ä¡":"g","É ":"g","á¸¡":"g","á¶ƒ":"g","Ç¥":"g","á¸«":"h","ÈŸ":"h","á¸©":"h","Ä¥":"h","â±¨":"h","á¸§":"h","á¸£":"h","á¸¥":"h","É¦":"h","áº–":"h","Ä§":"h","Æ•":"hv","Ã":"i","Ä":"i","Ç?":"i","Ã®":"i","Ã¯":"i","á¸¯":"i","á»‹":"i","È‰":"i","Ã¬":"i","á»‰":"i","È‹":"i","Ä«":"i","Ä¯":"i","á¶–":"i","É¨":"i","Ä©":"i","á¸":"i","ê?º":"d","ê?¼":"f","áµ¹":"g","êžƒ":"r","êž…":"s","êž‡":"t","ê?":"is","Ç°":"j","Äµ":"j","Ê?":"j","É‰":"j","á¸±":"k","Ç©":"k","Ä·":"k","â±ª":"k","ê?ƒ":"k","á¸³":"k","Æ™":"k","á¸µ":"k","á¶„":"k","ê??":"k","ê?…":"k","Äº":"l","Æš":"l","É¬":"l","Ä¾":"l","Ä¼":"l","á¸½":"l","È´":"l","á¸·":"l","á¸¹":"l","â±¡":"l","ê?‰":"l","á¸»":"l","Å€":"l","É«":"l","á¶…":"l","É":"l","Å‚":"l","Ç‰":"lj","Å¿":"s","áºœ":"s","áº›":"s","áº?":"s","á¸¿":"m","á¹?":"m","á¹ƒ":"m","É±":"m","áµ¯":"m","á¶†":"m","Å„":"n","Åˆ":"n","Å†":"n","á¹‹":"n","Èµ":"n","á¹…":"n","á¹‡":"n","Ç¹":"n","É²":"n","á¹‰":"n","Æž":"n","áµ°":"n","á¶‡":"n","É³":"n","Ã±":"n","ÇŒ":"nj","Ã³":"o","Å?":"o","Ç’":"o","Ã´":"o","á»‘":"o","á»™":"o","á»“":"o","á»•":"o","á»—":"o","Ã¶":"o","È«":"o","È¯":"o","È±":"o","á»?":"o","Å‘":"o","È?":"o","Ã²":"o","á»?":"o","Æ¡":"o","á»›":"o","á»£":"o","á»?":"o","á»Ÿ":"o","á»¡":"o","È?":"o","ê?‹":"o","ê??":"o","â±º":"o","Å?":"o","á¹“":"o","á¹‘":"o","Ç«":"o","Ç":"o","Ã¸":"o","Ç¿":"o","Ãµ":"o","á¹?":"o","á¹?":"o","È":"o","Æ£":"oi","ê??":"oo","É›":"e","á¶“":"e","É”":"o","á¶—":"o","È£":"ou","á¹•":"p","á¹—":"p","ê?“":"p","Æ¥":"p","áµ±":"p","á¶ˆ":"p","ê?•":"p","áµ½":"p","ê?‘":"p","ê?™":"q","Ê ":"q","É‹":"q","ê?—":"q","Å•":"r","Å™":"r","Å—":"r","á¹™":"r","á¹›":"r","á¹?":"r","È‘":"r","É¾":"r","áµ³":"r","È“":"r","á¹Ÿ":"r","É¼":"r","áµ²":"r","á¶‰":"r","É?":"r","É½":"r","â†„":"c","êœ¿":"c","É˜":"e","É¿":"r","Å›":"s","á¹¥":"s","Å¡":"s","á¹§":"s","ÅŸ":"s","Å?":"s","È™":"s","á¹¡":"s","á¹£":"s","á¹©":"s","Ê‚":"s","áµ´":"s","á¶Š":"s","È¿":"s","É¡":"g","á´‘":"o","á´“":"o","á´?":"u","Å¥":"t","Å£":"t","á¹±":"t","È›":"t","È¶":"t","áº—":"t","â±¦":"t","á¹«":"t","á¹":"t","Æ":"t","á¹¯":"t","áµµ":"t","Æ«":"t","Êˆ":"t","Å§":"t","áµº":"th","É?":"a","á´‚":"ae","Ç?":"e","áµ·":"g","É¥":"h","Ê®":"h","Ê¯":"h","á´‰":"i","Êž":"k","êž?":"l","É¯":"m","É°":"m","á´”":"oe","É¹":"r","É»":"r","Éº":"r","â±¹":"r","Ê‡":"t","ÊŒ":"v","Ê?":"w","ÊŽ":"y","êœ©":"tz","Ãº":"u","Å":"u","Ç”":"u","Ã»":"u","á¹·":"u","Ã¼":"u","Ç˜":"u","Çš":"u","Çœ":"u","Ç–":"u","á¹³":"u","á»¥":"u","Å±":"u","È•":"u","Ã¹":"u","á»§":"u","Æ°":"u","á»©":"u","á»±":"u","á»«":"u","á»":"u","á»¯":"u","È—":"u","Å«":"u","á¹»":"u","Å³":"u","á¶™":"u","Å¯":"u","Å©":"u","á¹¹":"u","á¹µ":"u","áµ«":"ue","ê?¸":"um","â±´":"v","ê?Ÿ":"v","á¹¿":"v","Ê‹":"v","á¶Œ":"v","â±±":"v","á¹½":"v","ê?¡":"vy","áºƒ":"w","Åµ":"w","áº…":"w","áº‡":"w","áº‰":"w","áº?":"w","â±³":"w","áº˜":"w","áº?":"x","áº‹":"x","á¶?":"x","Ã½":"y","Å·":"y","Ã¿":"y","áº?":"y","á»µ":"y","á»³":"y","Æ´":"y","á»·":"y","á»¿":"y","È³":"y","áº™":"y","É?":"y","á»¹":"y","Åº":"z","Å¾":"z","áº‘":"z","Ê‘":"z","â±¬":"z","Å¼":"z","áº“":"z","È¥":"z","áº•":"z","áµ¶":"z","á¶Ž":"z","Ê?":"z","Æ¶":"z","É€":"z","ï¬€":"ff","ï¬ƒ":"ffi","ï¬„":"ffl","ï¬?":"fi","ï¬‚":"fl","Ä³":"ij","Å“":"oe","ï¬†":"st","â‚?":"a","â‚‘":"e","áµ¢":"i","â±¼":"j","â‚’":"o","áµ£":"r","áµ¤":"u","áµ¥":"v","â‚“":"x"};return latin_map[x]||x})};window.vBulletin=window.vBulletin||{};vBulletin.cookie=vBulletin.cookie||{};vBulletin.cookie.convertBbarrayCookie=function(cookie,dir){cookie=cookie||"";dir=dir||"get";if(dir=="set"){cookie=cookie.replace(/"/g,".");cookie=cookie.replace(/:/g,"-");cookie=cookie.replace(/;/g,"_")}else{cookie=cookie.replace(/\./g,'"');cookie=cookie.replace(/-/g,":");cookie=cookie.replace(/_/g,";")}return cookie};vBulletin.cookie.fetchBbarrayCookie=function(cookiename,id){if(typeof vBulletin.cookie.bbarraycookiecache=="undefined"){vBulletin.cookie.bbarraycookiecache={}}var cookie=$.cookie(pageData.cookie_prefix+cookiename);if(cookie!=""&&!vBulletin.cookie.bbarraycookiecache[cookiename]){try{vBulletin.cookie.bbarraycookiecache[cookiename]=$.parseJSON(vBulletin.cookie.convertBbarrayCookie(cookie))}catch(e){vBulletin.cookie.bbarraycookiecache[cookiename]=null}}if(vBulletin.cookie.bbarraycookiecache[cookiename]){return vBulletin.cookie.bbarraycookiecache[cookiename][id]?vBulletin.cookie.bbarraycookiecache[cookiename][id]:null}else{return null}};vBulletin.cookie.setBbarrayCookie=function(cookiename,id,value,permanent){if(typeof vBulletin.cookie.bbarraycookiecache=="undefined"){vBulletin.cookie.bbarraycookiecache={}}var cookie=$.cookie(pageData.cookie_prefix+cookiename);if(cookie!=""&&!vBulletin.cookie.bbarraycookiecache[cookiename]){try{vBulletin.cookie.bbarraycookiecache[cookiename]=$.parseJSON(vBulletin.cookie.convertBbarrayCookie(cookie))}catch(e){vBulletin.cookie.bbarraycookiecache[cookiename]=null}}if(!vBulletin.cookie.bbarraycookiecache[cookiename]){vBulletin.cookie.bbarraycookiecache[cookiename]={}}vBulletin.cookie.bbarraycookiecache[cookiename][id]=value;var cookieoptions={path:pageData.baseurl_path};if(permanent){cookieoptions.expires=365}$.cookie(pageData.cookie_prefix+cookiename,vBulletin.cookie.convertBbarrayCookie(JSON.stringify(vBulletin.cookie.bbarraycookiecache[cookiename]),"set"),cookieoptions)};(function preInit(){(function(){$("#main-navbar .secondary-nav").removeClass("h-disabled");$("#idLoginIframe").on("load",function(e){try{var $iframe=$(this);var $iframeContent=$iframe.contents().find("html")[0];var h=$iframeContent.scrollHeight;if(h>0){$iframe.height(h);$iframe.parent().height(h)}}catch(err){}});$("#main-navbar .username-container").on("click",function(e){var $container=$(this),$subList=$("> ul",$container);if($container.closest(".secondary-nav").hasClass("h-disabled")){return false}if($container.hasClass("username-container-active")){e.stopPropagation();try{e.target.parentNode.click()}catch(err){}$subList.slideUp("fast");$container.removeClass("username-container-active");return $subList.hasClass("submenu")}var $iframe=$("#idLoginIframe");$iframe.closest("ul").show();$iframe.trigger("load");$iframe.closest("ul").hide();$container.addClass("username-container-active");$subList.css("top",$container.outerHeight()).slideDown("fast");return false});$("body").on("click",function(e){if($(e.target).closest(".username-container").size()==0){$(".username-container > ul").slideUp("fast");$(".username-container").removeClass("username-container-active")}})})();$(".announcement-tabs").tabs({fx:{opacity:"toggle"},show:function(event,ui){var announcement_id=$(ui.panel).attr("data-id"),announcements_displayed=vBulletin.cookie.fetchBbarrayCookie("announcements_displayed",announcement_id);if(!announcements_displayed){vBulletin.cookie.setBbarrayCookie("announcements_displayed",announcement_id,1,true)}}}).each(function(){var self=$(this),tablength=$("> .tab",self).length;$(".tab",self).each(function(){var index=parseInt($(this).attr("data-index")),panel=$(this);$("span.prev",panel)[index==0?"hide":"show"]();$("span.next",panel)[index==tablength-1?"hide":"show"]();$("span.prev",panel).on("click",function(e){self.tabs("select",index-1)});$("span.next",panel).on("click",function(e){self.tabs("select",index+1)});var condoptions={condensedLength:250,minTrail:20,delim:" ",moreText:$(".condense-text .see-more",self).html(),lessText:$(".condense-text .see-less",self).html(),ellipsis:"...",moreSpeed:"fast",lessSpeed:"fast",easing:"linear"};$(".announcementtext",panel).removeClass("h-hide").condense(condoptions)})});$(".ui-tabs .ui-tabs-nav > li").addClass("ui-state-disabled");$(".announcement-tabs .ui-tabs-nav > li").removeClass("ui-state-disabled")})();window.vBulletin.getAjaxBaseurl=function(){if(pageData.baseurl.indexOf("http://")==0){return pageData.baseurl.substring(5)}else{if(pageData.baseurl.indexOf("https://")==0){return pageData.baseurl.substring(6)}else{return pageData.baseurl}}};window.vBulletin.normalizeAjaxUrl=function(urlToNormalize){if(urlToNormalize.indexOf("http://")==0){return urlToNormalize.substring(5)}else{if(urlToNormalize.indexOf("https://")==0){return urlToNormalize.substring(6)}else{return urlToNormalize}}};window.vBulletin.pageHasSelectors=function(selectors){if($.isArray(selectors)&&selectors.length>0&&$.trim(selectors.toString())!=""){var found=false;$.each(selectors,function(index,value){if($(value).length>0){found=true;return false}});return found}return true};window.vBulletin.areJsonObjectsEqual=function(a,b){var check=function(a,b){for(var attr in a){if(a.hasOwnProperty(attr)&&b.hasOwnProperty(attr)){var attrA=a[attr],attrB=b[attr];if(attrA!=attrB){if(attrA instanceof Array&&attrB instanceof Array){if($(attrA).not(attrB).length>0||$(attrB).not(attrA).length>0){return false}else{continue}}else{return false}switch(attrA.constructor){case Object:if(!window.vBulletin.areJsonObjectsEqual(attrA,attrB)){return false}break;case Function:if(attrA.toString()!=attrB.toString()){return false}break;default:return false}}}else{return false}}return true};return(Object.keys(a).length==Object.keys(b).length)?check(a,b):false};window.vBulletin.ajaxSetup=(function(){var initialized=false;return{init:function(){if(initialized){return }initialized=true;$.ajaxSetup({contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}}})();window.vBulletin.ajaxSetup.init();window.vBulletin.ajaxProfile=(function(){var ajaxRequests=[],initialized=false,enabled=true,canDisplay=false;return{init:function(){if(initialized){return }initialized=true;$(function(){if($("#debug-information").length==0){enabled=false}$("<ol />").attr("id","debug-ajax-request-list").hide().css({height:"150px",overflow:"auto",padding:"4px",border:"1px solid #CCC",background:"#EEE","margin-top":"2px","margin-bottom":"4px"}).appendTo($("#debug-information #debug-ajax-request-count").closest("li"));$("#debug-information #debug-ajax-request-count").css("cursor","pointer").on("click",function(){$("#debug-ajax-request-list").toggle()});canDisplay=true});$.ajaxPrefilter(function(options,originalOptions,jqXHR){if(!enabled){return }ajaxRequests.push({displayed:false,url:options.url,relUrl:""});if(canDisplay){$("#debug-information #debug-ajax-request-count").text(ajaxRequests.length);$.each(ajaxRequests,function(){if(!this.displayed){this.displayed=true;this.relUrl=this.url.indexOf(pageData.baseurl)==0?this.url.substring(pageData.baseurl.length):this.url;$("#debug-ajax-request-list").append($("<li />").text(this.relUrl))}})}})}}})();window.vBulletin.ajaxProfile.init();window.vBulletin.loadingIndicator=(function(){var calledCount=0,initialized=false,timeoutId=false,ajaxToSuppressCount=0,ajaxSuppressedCount=0;return{init:function(){if(initialized){return }$(".js-loading-indicator").ajaxStart(function(){window.vBulletin.loadingIndicator.show("ajaxStart")});$(".js-loading-indicator").ajaxStop(function(){window.vBulletin.loadingIndicator.hide("ajaxStop")});initialized=true},show:function(source){if(ajaxToSuppressCount>0&&source=="ajaxStart"){--ajaxToSuppressCount;++ajaxSuppressedCount;console.log("vBulletin.loadingIndicator.show ajax indicator suppressed");return }++calledCount;console.log("vBulletin.loadingIndicator.show Counter: "+calledCount+" Source: "+(source||"Unspecified"));if(calledCount>0){timeoutId=window.setTimeout(function(){if(timeoutId){$(".js-loading-indicator").show();timeoutId=false}},1000)}},hide:function(source){if(ajaxSuppressedCount>0&&source=="ajaxStop"){--ajaxSuppressedCount;console.log("vBulletin.loadingIndicator.hide ajax indicator suppressed");return }--calledCount;calledCount=calledCount<0?0:calledCount;if(!source){calledCount=0}console.log("vBulletin.loadingIndicator.hide Counter: "+calledCount+" Source: "+(source||"Unspecified"));if(calledCount<1){if(timeoutId){window.clearTimeout(timeoutId);timeoutId=false}$(".js-loading-indicator").hide()}},suppressNextAjaxIndicator:function(){++ajaxToSuppressCount}}})();window.vBulletin.phrase=window.vBulletin.phrase||{};window.vBulletin.phrase.precache=window.vBulletin.phrase.precache||[];window.vBulletin.phrase.cache=window.vBulletin.phrase.cache||{};window.vBulletin.phrase.uncachable=window.vBulletin.phrase.uncachable||[];window.vBulletin.phrase.render=function(args){var str=args[0];for(var i=1;i<args.length;++i){str=str.replace(new RegExp("%"+i+"\\$s","gm"),args[i])}return str};window.vBulletin.phrase.remoteGet=function(key,precache){precache.push(key);var toCache=[];var ret=key;$.each(precache,function(i,element){if($.inArray(element,toCache)===-1&&element!=""){toCache.push(element)}});if(toCache.length>0){vBulletin.loadingIndicator.suppressNextAjaxIndicator();$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/phrase/fetch",async:false,data:({phrases:toCache}),type:"POST",dataType:"json",success:function(result){if(result){if(typeof (result[key])!="undefined"){ret=result[key]}window.vBulletin.cache.setBucket("phrases");$.each(result,function(phraseKey,phraseText){window.vBulletin.cache.set(phraseKey,phraseText)});precache.length=0}else{console.warn("Unexpected result when fetching phrases")}},error:function(xhr,statusText,error){console.warn("Error when fetching phrases: {0}".format(error))}})}return ret};window.vBulletin=window.vBulletin||{};window.vBulletin.phrase=window.vBulletin.phrase||{};window.vBulletin.phrase.precache=window.vBulletin.phrase.precache||[];window.vBulletin.phrase.precache=$.merge(window.vBulletin.phrase.precache,["admin","admin_auth","all_changes_made_will_be_lost_would_you_like_to_continue","april","attach_link","attach_video","august","cancel","cancel_edit","close","compare_versions","conversation","december","done","edit_conversation","email_addresses_must_match","error","error_fetching_online_users_x","error_loading_ckeditor_script","error_loading_editor","error_loading_post","error_posting_comment_code_x","error_saving_vote","error_x","existing_reply_will_be_deleted","february","flag_a_post","follow","follow_error","following","following_pending","following_remove","friday_min","go_to_first_new_post","hour","inlinemod_auth_login_failed","inlinemod_auth_login_first","inlinemod_auth_password_empty","invalid_data","invalid_data_requested","invalid_email_address","invalid_request","invalid_server_response_please_try_again","invalid_special_channel_subscribe_request","invalid_user_permissions","invalid_username_specified","invalid_username_specified_maxlength_x","invalid_username_specified_minlength_x","invalid_query_definition_x","january","join","joined","join_error","july","june","leave","logged_out_while_editing_post","login","login_success_admin_auth","march","may","minute","moderator","monday_min","new_posts","no","no_create_permissions","no_icon","no_leave_channel_permission","no_one_voted","no_permission","no_update_permissions","no_valid_tags_found","not_logged_no_permission","november","now","october","onbeforeunload_message_while_editing_post","password_must_be_at_least_four_chars","passwords_must_match","people_who_liked","physically_remove_blog","physically_remove_comment","physically_remove_media","physically_remove_reply","physically_remove_topic","physically_remove_visitorMessage","please_enter_a_username","please_enter_a_valid_url_and_click_attach","please_enter_link_url","please_enter_video_url","please_enter_your_comment","please_enter_your_email_address","please_enter_your_reason_why_you_want_to_flag_this_post","please_provide_search_string","please_select_a_day","please_select_a_month","please_select_a_year","post_comment","post_history","posttype_blog","posttype_comment","posttype_media","posttype_reply","posttype_topic","posttype_visitorMessage","saturday_min","search","see_less","see_more","select_option_and_click_delete_button_blog","select_option_and_click_delete_button_comment","select_option_and_click_delete_button_media","select_option_and_click_delete_button_reply","select_option_and_click_delete_button_topic","select_option_and_click_delete_button_visitorMessage","send_report","september","share_post_link_help","soft_delete_blog","soft_delete_comment","soft_delete_media","soft_delete_notes_blog","soft_delete_notes_comment","soft_delete_notes_media","soft_delete_notes_reply","soft_delete_notes_topic","soft_delete_notes_visitorMessage","soft_delete_reply","soft_delete_topic","soft_delete_visitorMessage","sunday_min","thanks_for_signing_up_log_in","the_report_has_been_sent","time","tuesday_min","thursday_min","unable_to_check_admin_permissions","unexpected_error","unfollow_error","unsubscribe","unsubscribe_overlay_error","unvote_cap","user_name_x_already_in_use_choose_different_name","vote_a_post","vote_cap","wednesday_min","xs_avatar","yes","you_have_a_pending_edit_unsaved"]);window.vBulletin.cache.initBucket("phrases",pageData.phrasedate,window.vBulletin.phrase.precache,window.vBulletin.phrase.remoteGet);window.vBulletin.phrase.get=function(){if(arguments.length<1){console.log("vBulletin.phrase.get() called with no parameters");return""}if(typeof arguments[0]=="object"){arguments=arguments[0]}window.vBulletin.cache.setBucket("phrases");var phrase=window.vBulletin.cache.get(arguments[0]);arguments[0]=phrase;return window.vBulletin.phrase.render(arguments)};window.vBulletin.getScrollbarWidth=function(){if($("body").data("scrollbar-width")){return $("body").data("scrollbar-width")}var $outer=$('<div style="width:50px;height:50px;overflow:auto;position:absolute;top:-99999px;"><div /></div>').appendTo("body"),$inner=$outer.children(),width=$inner.innerWidth()-$inner.height(99).innerWidth();$outer.remove();$("body").data("scrollbar-width",width);return width};window.vBulletin.options=window.vBulletin.options||{};window.vBulletin.options.precache=window.vBulletin.options.precache||[];window.vBulletin.options.remoteGet=function(key,precache){var toCache=[key];$.each(precache,function(i,element){if($.inArray(element,toCache)===-1){toCache.push(element)}});var ret=null;$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/options/fetchValues",async:false,data:({options:toCache}),type:"POST",dataType:"json",success:function(result){if(result){vBulletin.cache.setBucket("options");$.each(result,function(optionName,optionValue){if(optionName==key){ret=optionValue}vBulletin.cache.set(optionName,optionValue)});precache.length=0}else{console.warn("Unexpected result when fetching options")}},error:function(xhr,statusText,error){console.warn("Error when fetching options: {0}".format(error))}});return ret};window.vBulletin=window.vBulletin||{};window.vBulletin.options=window.vBulletin.options||{};window.vBulletin.options.precache=window.vBulletin.options.precache||[];window.vBulletin.options.precache=$.merge(window.vBulletin.options.precache,["crontab","bbtitle","markinglimit"]);vBulletin.cache.initBucket("options",window.pageData.optionsdate,window.vBulletin.options.precache,window.vBulletin.options.remoteGet);window.vBulletin.options.get=function(optionName){window.vBulletin.cache.setBucket("options");return window.vBulletin.cache.get(optionName)};window.vBulletin.openAuthDialog=function(callback,title,callbackClickNo){title=title||"inlinemod_auth";callbackClickNo=callbackClickNo||function(){};var $authDialog=openConfirmDialog({title:vBulletin.phrase.get(title),message:vBulletin.phrase.get("loading")+"...",width:500,dialogClass:"inlinemod-auth-dialog loading",buttonLabel:{yesLabel:vBulletin.phrase.get("login"),noLabel:vBulletin.phrase.get("cancel")},primaryButton:"yes",onClickYesWithAjax:true,onClickYes:function(){var $authForm=$authDialog.find(".inlinemod-auth-form"),password=$authForm.find(':input[name="password"]').val(),$errorBox=$authForm.find(".error-msg-box");$errorBox.text("").addClass("h-hide");$.ajax({url:vBulletin.normalizeAjaxUrl($authForm.attr("action")),data:{password:password},type:"POST",dataType:"json",success:function(result){if(result.error){$errorBox.text(vBulletin.phrase.get(result.error)).removeClass("h-hide")}else{$authDialog.dialog("close");$authDialog.dialog("close");return callback()}},error:function(xhr,statusText,error){console.log("/auth/inlinemodLogin failed, error: "+error);openAlertDialog({title:vBulletin.phrase.get(title),message:xhr.status,iconType:"error"})}})},onClickNo:callbackClickNo});$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/render/inlinemod_auth",type:"POST",dataType:"json",success:function(result){console.log("/ajax/render/inlinemod_auth");if(result&&!result.errors){$(".inlinemod-auth-dialog").removeClass("loading");$(".dialog-content .message",$authDialog).html(result);$authDialog.dialog("option","position","center");$('[name="password"]',$authDialog).on("keydown",function(e){if(e.which==13){e.preventDefault();$("#btnConfirmDialogYes",$authDialog).click()}}).focus()}else{console.log("/ajax/render/inlinemod_auth successful, but response was not valid");openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("invalid_server_response_please_try_again"),iconType:"error",onAfterClose:function(){$authDialog.dialog("close")}})}},error:function(xhr,statusText,error){console.log("/ajax/render/inlinemod_auth failed, error: "+error);openAlertDialog({title:vBulletin.phrase.get(title),message:vBulletin.phrase.get("error_loading_delete_form_x",xhr.status),iconType:"error",onAfterClose:function(){$authDialog.dialog("close")}})}})};window.vBulletin.assertUserHasAdminPermission=function(adminPermission,context,successCallback){if($(context).data("in-progress")){return false}$("body").css("cursor","wait");var caller=arguments.callee.caller;$(context).data("in-progress",true);$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/user/currentUserHasAdminPermission",data:({adminPermission:adminPermission}),type:"POST",dataType:"json",complete:function(){$("body").css("cursor","auto");$(context).data("in-progress",null)},success:function(result){console.log("ajax/api/user/currentUserHasAdminPermission result:"+JSON.stringify(result));if(result===true){successCallback()}else{if(result&&result.errors&&result.errors.length>0){if(result.errors[0]=="auth_required"){window.vBulletin.openAuthDialog(function(){caller.apply(context)},"admin_auth");return }openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("nopermission_loggedout"),iconType:"error",onAfterClose:function(){$("#config-dialog").dialog("close");window.location.reload()}});$("#config-dialog .loader").hide()}else{openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("unable_to_check_admin_permissions"),iconType:"error",onAfterClose:function(){$("#config-dialog").dialog("close");window.location.reload()}});$("#config-dialog .loader").hide()}}},error:function(xhr,statusText,error){console.log("ajax/api/user/currentUserHasAdminPermission error: "+error);openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("unable_to_check_admin_permissions"),iconType:"error",onAfterClose:function(){$("#config-dialog").dialog("close");window.location.reload()}});$("#config-dialog .loader").hide()}})};vBulletin.selectTabByIndex=function(selectedTabIndex){var $self=this instanceof $?this:$(this);if($self.length&&selectedTabIndex>-1){$self.data("isTrigger",true).tabs("select",selectedTabIndex).find(".ui-tabs-nav li").removeClass("ui-state-focus").eq(selectedTabIndex).addClass("ui-state-focus").find("a").focus();$self.data("isTrigger",null)}};vBulletin.tabify=function(tabParams){var $self=this instanceof $?this:$(this);if($self.length){var defaultOptions={tabOptions:{},tabHistory:null,allowHistory:false,tabParamAsQueryString:true,hash:"",getTabIndexByHash:function(){return -1}};tabParams=$.extend({},defaultOptions,tabParams);if(tabParams.tabHistory instanceof vBulletin.history.instance&&tabParams.tabHistory.isEnabled()){$self.on("tabscreate",function(event,ui){var qs=vBulletin.parseQueryString(location.search,["_"]),qsLen=Object.keys(qs).length,state=tabParams.tabHistory.getState();if(qsLen==1&&typeof qs.tab!="undefined"&&(!state||$.isEmptyObject(state.data))){var objState={from:"tabs",tab:qs.tab?"#"+qs.tab:""};tabParams.tabHistory.setDefaultState(objState,document.title,location.href)}tabParams.tabHistory.setStateChange(function(e){var state=tabParams.tabHistory.getState();if(state.data.from=="tabs"){tabParams.tabHistory.log(state.data,state.title,state.url);var selectedTabIndex=tabParams.getTabIndexByHash(state.data.tab),qs=vBulletin.parseQueryString(state.url,["tab","_"]);if($self.tabs("option","selected")!=selectedTabIndex){vBulletin.selectTabByIndex.call($self,selectedTabIndex);if(!$.isEmptyObject(qs)){$(window).trigger("statechange.filter",["tabs",qs])}}else{if(!$.isEmptyObject(qs)){$(window).trigger("statechange.filter",["tabs",qs])}else{var context=state.data.tab?$(state.data.tab):$($self.closest(".canvas-widget").data("widget-default-tab")),$defaultCheckedFilters=$(".toolbar-filter-overlay .filter-options .js-default-checked",context);if($defaultCheckedFilters.length){$defaultCheckedFilters.prop("checked",true).first().data("bypass-filter-display",true).trigger("change",[true]).data("bypass-filter-display",null);$(".filtered-by",context).addClass("h-hide").find(".filter-text-wrapper").empty()}else{$(".conversation-toolbar .js-default-checked",context).first().trigger("click",[true])}}}}},"tabs");if(typeof tabParams.tabOptions.create=="function"){tabParams.tabOptions.create.call($self[0],event,ui)}})}if(tabParams.allowHistory&&tabParams.tabHistory instanceof vBulletin.history.instance){$self.on("tabsselect",function(event,ui){if(typeof tabParams.tabOptions.select=="function"&&tabParams.tabOptions.select.call(this,event,ui)===false){return false}var url;if(!tabParams.tabHistory.isEnabled()){url=vBulletin.makeFilterUrlFromSelectedFilters(ui.panel,ui.tab.hash.replace("#",""),tabParams.tabParamAsQueryString,tabParams.hash);location.href=url;return false}if(!$self.data("isTrigger")){var objState={from:"tabs",tab:ui.tab.hash};url=vBulletin.makeFilterUrlFromSelectedFilters(ui.panel,ui.tab.hash.replace("#",""),tabParams.tabParamAsQueryString);tabParams.tabHistory.pushState(objState,document.title,url)}})}$self.tabs(tabParams.tabOptions)}return $self};vBulletin.parseUrl=function(url){var a=document.createElement("a"),pathname;a.href=url||"/";pathname=a.pathname;if(pathname.indexOf("/")!=0){pathname="/"+pathname}return{protocol:a.protocol,hostname:a.hostname,port:a.port,pathname:pathname,search:a.search,hash:a.hash}};vBulletin.makeHistoryUrl=function(currentUrl,pageNumber,tabParams,filterParams,hash){var url=vBulletin.makePaginatedUrl(currentUrl,pageNumber);url=vBulletin.makeTabUrl(url,tabParams.tab,tabParams.tabParamAsQueryString);url=vBulletin.makeFilterUrl(url,filterParams.filterName,filterParams.filterValue,filterParams.context,hash);return url};vBulletin.makeTabUrl=function(url,tab,tabParamAsQueryString,hash){if(url){var parsedUrl=vBulletin.parseUrl(url),re;if(tabParamAsQueryString){re=/([?+|&+])tab=\w+[-\w]*/i;if(parsedUrl.search.match(re)){url=parsedUrl.pathname+parsedUrl.search.replace(re,"$1tab="+tab)}else{if(parsedUrl.search){url=parsedUrl.pathname+parsedUrl.search+"&tab="+tab}else{url=parsedUrl.pathname+"?tab="+tab}}}else{var nodes=parsedUrl.pathname.split("/");re="/"+nodes[nodes.length-1]+"$";url=parsedUrl.pathname.replace(new RegExp(re),"/"+tab)+parsedUrl.search}}else{url="/"}if(hash){url+="#"+hash}return url};vBulletin.makePaginatedUrl=function(url,pageNumber){if(url){var m=url.match(/\/page[0-9]+/);if(m){if(pageNumber>1){url=url.replace(m[0],"/page"+pageNumber)}else{url=url.replace(m[0],"")}}else{if(pageNumber>1){if(url.match(/\?/)){url=url.replace(/\?/,"/page"+pageNumber+"?")}else{if(url.match(/\#/)){url=url.replace(/\#.*/,"/page"+pageNumber)}else{url+="/page"+pageNumber}}}}}return url};vBulletin.makeFilterUrl=function(url,filterName,filterValue,context,hash,removeFilter){removeFilter=removeFilter||false;url=url||location.href;var $filteredBy=$(".filtered-by",context),parsedUrl=vBulletin.parseUrl(url),s=parsedUrl.search;var $filterButton=$(".js-button-filter.js-default-checked.js-checked",context);if($filterButton.data("filter-name")==filterName&&$filterButton.data("filter-value")==filterValue){removeFilter=true}if(!removeFilter&&(($filteredBy.data("clicked")&&$('.toolbar-filter-overlay input[name="{0}"][value="{1}"]'.format(filterName,filterValue),context).hasClass("js-default-checked"))||($('.toolbar-search-form input[name="{0}"]'.format(filterName),context).length&&!filterValue))){removeFilter=true;$filteredBy.data("clicked",null)}url=parsedUrl.pathname;if(s&&s.length>1){if(s.match(new RegExp(filterName+"=","i"))){var params=vBulletin.parseQueryString(s);if(!$.isEmptyObject(params)){var qs="";$.each(params,function(i,value){if(!removeFilter||i!=filterName){qs+="{0}={1}&".format(i,(i==filterName?filterValue:value))}});if(qs){url+="?"+qs.substring(0,qs.length-1)}}}else{if(!removeFilter){url+=s+"&{0}={1}".format(filterName,encodeURIComponent(filterValue))}else{url+=s}}}else{if(!removeFilter){url+="?{0}={1}".format(filterName,encodeURIComponent(filterValue))}}if(hash){url+="#"+hash}return url};vBulletin.getSelectedFilters=function($form,radioFiltersOnly){var filters={};if(!radioFiltersOnly){var formData=$form.serializeArray();$.each(formData,function(index,field){if(field.name!="securitytoken"){if(field.name.slice(-2)=="[]"){var fields=field.name.split("[]");filters[fields[0]]=filters[fields[0]]||[];filters[fields[0]].push(field.value)}else{filters[field.name]=field.value}}})}else{var $filteredByText=$form.parent().find(".filtered-by .filter-text").filter(":visible");$form.find(":input:radio:checked").each(function(index,field){var $field=$(field);if($field.hasClass("js-default-checked")&&($filteredByText.length==0||$filteredByText.filter('[data-filter-name={0}][data-filter-value="{1}"]').length==0)){return true}if(field.name.slice(-2)=="[]"){var fields=field.name.split("[]");filters[fields[0]]=filters[fields[0]]||[];filters[fields[0]].push(field.value)}else{filters[field.name]=field.value}})}return filters};vBulletin.makeFilterUrlFromSelectedFilters=function(context,tabId,tabParamAsQueryString,hash){var qs,url=location.pathname.replace(/\/page[0-9]+/,""),$filterForm=$(".toolbar-filter-overlay",context),selectedFilters=vBulletin.getSelectedFilters($filterForm,true),pagenum=$(".pagenav-form .js-pagenum",context).val()||1,searchKeyword=$(".toolbar-search-form .js-filter-search",context).val()||"",$canvasWidget=$(context).closest(".canvas-widget"),allowHistory=$(".conversation-toolbar-wrapper",context).data("allow-history")=="1",filterHistory=new vBulletin.history.instance(allowHistory),defaultTabId=$canvasWidget.data("widget-default-tab")||$canvasWidget.find(".ui-tabs-nav > li:first-child a").attr("href");if($.isEmptyObject(selectedFilters)){$(".conversation-toolbar .js-button-filters",context).each(function(){var $selectedFilter=$(".js-button-filter.js-checked:not(.js-default-checked)",this);if($selectedFilter.length){selectedFilters[$selectedFilter.data("filter-name")]=$selectedFilter.data("filter-name")}})}if(pagenum>1&&filterHistory.isEnabled()){url+="/page"+pagenum}if(tabId){if(tabParamAsQueryString){if(defaultTabId!=("#"+tabId)){selectedFilters.tab=tabId;if(!filterHistory.isEnabled()){url+="?tab="+tabId}}}else{url+="/"+tabId}}if(!filterHistory.isEnabled()){return url}if(searchKeyword){selectedFilters.q=searchKeyword}qs=$.param(selectedFilters);return url+(qs?"?"+qs:"")+(hash?"#"+hash:"")};vBulletin.parseQueryString=function(url,exclude){var qs={},qm;if(url&&url.length>1){qm=url.indexOf("?");exclude=(exclude instanceof Array)?exclude:[];if(qm!=-1){var segments=url.substring(qm+1).split("&");$.each(segments,function(i,value){var q=value.split("=");if(exclude.length==0||($.inArray(q[0],exclude)==-1)){qs[q[0]]=decodeURIComponent((q[1]||"")).replace(/\+/g," ")}})}}return qs};vBulletin.pagination=function(userOptions){var options={context:document,onPageChanged:null,allowHistory:false};if(userOptions&&typeof userOptions=="object"){$.extend(options,userOptions)}var url,$pageNavForm=$(".pagenav-controls .pagenav-form",options.context),defaultPageNumber=Number($(".defaultpage",$pageNavForm).val())||1,$next=$(".arrow[rel=next]",$pageNavForm),$prev=$(".arrow[rel=prev]",$pageNavForm),paginationHistory=new vBulletin.history.instance(options.allowHistory);if(paginationHistory.isEnabled()){var qs=vBulletin.parseQueryString(location.search,["_"]),m=location.pathname.match(/\/page([0-9]+)/),state=paginationHistory.getState();if(m&&Number(m[1])>1&&$.isEmptyObject(qs)&&(!state||$.isEmptyObject(state.data))){url=vBulletin.makePaginatedUrl(location.href,defaultPageNumber);var objState={from:"pagination",page:defaultPageNumber};paginationHistory.setDefaultState(objState,document.title,url)}paginationHistory.setStateChange(function(e){var state=paginationHistory.getState();if(state.data.from=="pagination"){paginationHistory.log(state.data,state.title,state.url);if(location.search){var qs=vBulletin.parseQueryString(state.url,["_"]);if(!$.isEmptyObject(qs)){$(window).trigger("statechange.filter",["pagination",qs])}}else{var filterInstance=$(".conversation-toolbar .filter-wrapper",options.context).data("object-instance");if(filterInstance){filterInstance.resetFilters(true)}}if(typeof options.onPageChanged=="function"){var p=(state.data.page)?state.data.page:defaultPageNumber;options.onPageChanged.apply($pageNavForm.get(0),[p,false,!location.search])}}},"pagination")}function getTotalPages(){return parseInt(($(".pagetotal",$pageNavForm).html()||"").replace(/[^\d]+/g,""),10)||1}function updatePageNavigation(pageNumber,bypassFilter){var pageTotal=getTotalPages.apply(this);if(pageNumber<1){pageNumber=1}else{if(pageNumber>pageTotal){pageNumber=pageTotal}}$(".js-pagenum",$pageNavForm).val(pageNumber);if(pageNumber==pageTotal){$next.addClass("h-disabled").removeAttr("href")}else{$next.removeClass("h-disabled").attr("href",vBulletin.makePaginatedUrl(location.href,pageNumber+1))}if(pageNumber==1){$prev.addClass("h-disabled").removeAttr("href")}else{$prev.removeClass("h-disabled").attr("href",vBulletin.makePaginatedUrl(location.href,pageNumber-1))}if(typeof options.onPageChanged=="function"){options.onPageChanged.apply(this,[pageNumber,bypassFilter])}if(pageTotal>1&&paginationHistory.isEnabled()&&!bypassFilter){var state=paginationHistory.getState();if(!state||!state.data||!state.data.from||state.data.from!="filter_blogs"){if(pageNumber==1){url=$(".arrow[rel=next]",$pageNavForm).attr("href")}else{url=$(".arrow[rel=prev]",$pageNavForm).attr("href")}if(url){url=vBulletin.makePaginatedUrl(url,pageNumber);var objState={from:"pagination",page:pageNumber};paginationHistory.pushState(objState,document.title,url)}}}}function updateResultId(resultId){var cleanId=parseInt(resultId);if(cleanId&&typeof cleanId==="number"){$("input[name=result-id]",$pageNavForm).val(cleanId)}}function hideDisplaySeeMore(hide){$("a.see-all-btn",this).closest(".pagenav-controls")[hide?"addClass":"removeClass"]("h-hide")}$(".arrow",$pageNavForm).off("click").on("click",function(ev){if(!$(this).hasClass("h-disabled")){if(!paginationHistory.isEnabled()&&options.allowHistory){return true}var pageNumber=parseInt($(".js-pagenum",$pageNavForm).val())+(($(this).attr("rel")=="next")?1:-1);updatePageNavigation.apply(this,[pageNumber,false])}return false});function attachClickEventPageNavButtons(){$(".pagenav .button",options.context).off("click").on("click",function(ev){if(paginationHistory.isEnabled()){var pageNumber=parseInt($(this).data("page"));updatePageNavigation.apply(this,[pageNumber,false]);return false}return true}).each(function(){this.href=vBulletin.makePaginatedUrl(location.href,parseInt($(this).data("page")))})}attachClickEventPageNavButtons();$(".js-pagenum",$pageNavForm).off("keypress").on("keypress",function(ev){if(ev.keyCode==13){ev.preventDefault();var pageNumber=parseInt($(this).val(),10);var totalPages=getTotalPages.apply(this);if(pageNumber>totalPages){pageNumber=totalPages}if(pageNumber<1){pageNumber=1}if(paginationHistory.isEnabled()){updatePageNavigation.apply(this,[pageNumber,false])}else{if(options.allowHistory){location.href=vBulletin.makePaginatedUrl(location.href,pageNumber)}}}});this.updatePageInfo=function(pageInfo,bypassFilter){if(pageInfo&&typeof pageInfo=="object"){var totalPages=pageInfo.totalpages||1;$(".pagetotal",$pageNavForm).text(totalPages);if(typeof pageInfo.showseemore!="undefined"){if(pageInfo.showseemore){hideDisplaySeeMore.apply($pageNavForm,[false])}else{hideDisplaySeeMore.apply($pageNavForm,[true])}}pageInfo.perpage=vBulletin.conversation.POSTS_PER_PAGE;if(bypassFilter){$.get(pageData.baseurl+"/ajax/render/pagenav",{pagenav:pageInfo},function(result){if(result){$(".pagenav-container",options.context).replaceWith(result.template);attachClickEventPageNavButtons()}},"json")}updatePageNavigation.apply($pageNavForm,[pageInfo.pagenumber,bypassFilter])}};this.updateResultId=function(resultId){updateResultId(resultId)}};vBulletin.conversation=vBulletin.conversation||{};vBulletin.conversation.toggleCommentBox=function(){var container=$(this).closest(".list-item-body-wrapper").find(".comment-entry-box");container.slideToggle("fast",function(){var $commentBox=$(this).find(".comment-textbox");if($commentBox.is(":visible")){$commentBox.focus()}});container.find(".post-comment-cancel-btn").off("click").on("click",function(e){container.slideToggle();return false});return false};vBulletin.conversation.postComment=function(e,onCommentPosted){var self=this;var $commentBox=$(self).closest(".comment-entry-box").find(".comment-textbox");var commentText=$.trim($commentBox.val());if(!commentText||($commentBox.hasClass("placeholder")&&commentText==$commentBox.attr("placeholder"))){openAlertDialog({title:vBulletin.phrase.get("post_comment"),message:vBulletin.phrase.get("please_enter_your_comment"),iconType:"warning",onAfterClose:function(){$commentBox.focus()}});return false}$("body").css("cursor","wait");$(self).blur();var $post=$(self).closest(".list-item"),isBlogComment=$(self).closest(".comment-entry-box-blog").length==1?1:0;$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/post-comment",data:({text:commentText,parentid:$post.attr("data-node-id"),postindex:$post.find(".conversation-body .post-count").text().replace("#",""),view:$post.parent().hasClass("stream-view")?"stream":"thread",redirecturl:$commentBox.hasClass(".reload-on-post")?1:0,isblogcomment:isBlogComment,humanverify:{input:$(self).closest(".comment-entry-box").find('[name="humanverify[input]"]').val(),hash:$(self).closest(".comment-entry-box").find('[name="humanverify[hash]"]').val()},recaptcha_challenge_field:$(self).closest(".comment-entry-box").find('[name="recaptcha_challenge_field"]').val(),recaptcha_response_field:$(self).closest(".comment-entry-box").find('[name="recaptcha_response_field"]').val()}),type:"POST",dataType:"json",complete:function(xhr,statusText){console.log("post-comment complete.");$("body").css("cursor","auto");vBulletin.hv.reset()},success:function(result,statusText,xhr){console.log("post-comment successful! result:"+JSON.stringify(result));if(result){if(!result.error){if(typeof onCommentPosted=="function"){onCommentPosted.apply(self,[result])}if(!isBlogComment){$(self).closest(".comment-entry-box").slideToggle()}var currentthreadid=$post.attr("data-node-id");if(pageData.threadmarking=="0"||pageData.userid=="0"){vBulletin.cookie.setBbarrayCookie("discussion_view",currentthreadid,Math.round(new Date().getTime()/1000))}else{$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/node/markRead",data:{nodeid:currentthreadid},type:"POST",dataType:"json",complete:function(){},success:function(result){if(result&&!result.error){console.log("Topic "+currentthreadid+" is marked read successfully!")}else{console.log("Topic "+currentthreadid+" is marked read failed: "+result.error)}},error:function(xhr,statusText,error){console.log("Topic "+currentthreadid+" is marked read failed:"+error)}})}}else{openAlertDialog({title:vBulletin.phrase.get("conversation"),message:vBulletin.phrase.get("error_x",result.error),iconType:"warning"})}}else{openAlertDialog({title:vBulletin.phrase.get("conversation"),message:vBulletin.phrase.get("invalid_server_response_please_try_again"),iconType:"error"})}},error:function(xhr,statusText,error){console.log("post-comment failed! error:"+error);openAlertDialog({title:vBulletin.phrase.get("conversation"),message:vBulletin.phrase.get("error_posting_comment_code_x",xhr.status),iconType:"error"})}})};vBulletin.conversation.showIp=function(e){var $self=$(this),ip=$(this).data("post-ip"),host=$(this).data("post-host");openAlertDialog({title:vBulletin.phrase.get("ip_info"),message:vBulletin.phrase.get("ip_address_is")+": "+ip+"<br />"+vBulletin.phrase.get("host_name_is")+': <span class="ip-host-name loading">...</span>',iconType:"none"});vBulletin.AJAX({url:vBulletin.getAjaxBaseurl()+"/ajax/api/node/getHostName",data:{ip:ip},success:function(result,statusText,xhr){$(".ip-host-name").removeClass("loading").html(result)}});return false};vBulletin.conversation.showPostHistory=function(e){var $self=$(this);var nodeid=$(this).closest(".list-item").attr("data-node-id");var $compareDialog=openConfirmDialog({title:vBulletin.phrase.get("post_history"),message:vBulletin.phrase.get("loading")+"...",width:800,dialogClass:"post-history-dialog dialog-container dialog-box loading",buttonLabel:{yesLabel:vBulletin.phrase.get("compare_versions"),noLabel:vBulletin.phrase.get("cancel")},onAfterClose:function(){if(this.id=="btnConfirmDialogYes"){var $compareForm=$compareDialog.find(".post-history-form");var postData={oldpost:$compareForm.find("input:radio[name=old]:checked").val()||1,newpost:$compareForm.find("input:radio[name=new]:checked").val()||1,nodeid:nodeid};$("#btnConfirmDialogYes").hide();var $comparisonDialog=openConfirmDialog({title:vBulletin.phrase.get("post_history"),message:vBulletin.phrase.get("loading")+"...",width:800,dialogClass:"post-history-comparison-dialog dialog-container dialog-box loading",buttonLabel:{yesLabel:vBulletin.phrase.get("compare_versions"),noLabel:vBulletin.phrase.get("close")},onAfterClose:function(){$("#btnConfirmDialogYes").show()}});postForm($comparisonDialog,"post_history_form",postData)}}});postForm($compareDialog,"post_history_form",{nodeid:nodeid});function postForm(dialog,template,data){$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/render/"+template,data:data,type:"POST",dataType:"json",success:function(result){console.log("/ajax/render/"+template);if(result&&!result.errors){dialog.removeClass("loading").find(".dialog-content .message").html(result).find("[placeholder]").placeholder().end().end().dialog("option","position","center")}else{console.log("/ajax/render/"+template+" successful, but response was not valid: "+JSON.stringify(result));openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("invalid_server_response_please_try_again"),iconType:"error",onAfterClose:function(){dialog.dialog("close")}})}},error:function(xhr,statusText,error){console.log("/ajax/render/"+template+" failed, error: "+error);openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("error_loading_delete_form_x",xhr.status),iconType:"error",onAfterClose:function(){dialog.dialog("close")}})}})}};vBulletin.conversation.flagPost=function(e){var $self=$(this);var nodeid=$(this).closest(".list-item").attr("data-node-id");openPromptDialog({title:vBulletin.phrase.get("flag_a_post"),message:vBulletin.phrase.get("please_enter_your_reason_why_you_want_to_flag_this_post"),buttonLabel:{okLabel:vBulletin.phrase.get("send_report"),cancelLabel:vBulletin.phrase.get("cancel")},multiline:true,validation:{type:"string"},onClickOK:function(reason){$("body").css("cursor","wait");$.ajax({url:vBulletin.getAjaxBaseurl()+"/report/report",type:"post",data:{reason:reason,reportnodeid:nodeid},dataType:"json",success:function(response){if(response){if(response.error){console.log("/report/report failed, error: "+JSON.stringify(response.error));var msg;if(response.error.length>1){msg=vBulletin.phrase.get(response.error)}else{msg=vBulletin.phrase.get(response.error[0])}openAlertDialog({title:vBulletin.phrase.get("flag_a_post"),message:msg,iconType:"error"})}else{openAlertDialog({title:vBulletin.phrase.get("flag_a_post"),message:vBulletin.phrase.get("the_report_has_been_sent"),iconType:"",onAfterClose:function(){$("#prompt-dialog").dialog("close")}})}}},error:function(xhr,statusText,error){console.log("/report/report failed, error: "+error);openAlertDialog({title:vBulletin.phrase.get("flag_a_post"),message:vBulletin.phrase.get("unable_to_contact_server_please_try_again"),iconType:"error",onAfterClose:function(){$("#prompt-dialog").dialog("close")}})},complete:function(){$("body").css("cursor","default")}})}});return false};vBulletin.conversation.editPost=function(e,filterInstance){var self=$(this),conversationType,view,$conversationList=self.closest(".conversation-list");if(self.closest(".conversation-comments-wrapper").length>0){conversationType="comment"}var $editForm=$(".edit-conversation-container form",$conversationList);if($editForm.length>0){openAlertDialog({title:vBulletin.phrase.get("edit_conversation"),message:vBulletin.phrase.get("you_have_a_pending_edit_unsaved"),iconType:"warning",onAfterClose:function(){vBulletin.animateScrollTop($editForm.closest(".list-item").offset().top,{duration:"slow"})}});return }if(filterInstance&&filterInstance.isFilterSelected("conversations_on")){filterInstance.toggleNewConversations(false)}window.vBulletin.loadingIndicator.show();e.preventDefault();var nodeid=self.parent().attr("data-node-id");var container=(conversationType=="comment")?self.closest(".list-item"):self.closest(".list-item-body-wrapper");if($conversationList.hasClass("thread-view")){view="thread"}else{if($conversationList.hasClass("full-activity-view")){view="full-activity-stream"}else{if($conversationList.hasClass("activity-view")){view="activity-stream"}else{view="stream"}}}conversationType=conversationType||container.attr("data-node-type")||"";var index,postCount=$(".post-count",container).text()||"1";if(conversationType=="comment"&&(view=="thread"||$conversationList.closest(".blog-conversation-content-widget").length==1)){index=Number(postCount.replace("#",""))}else{index=Number(postCount.replace("#",""))-1}var saveEditCallback=function(response,statusText,xhr,$form){if(response&&response.error){window.vBulletin.loadingIndicator.hide();$form.find(".action-buttons .button").prop("disabled",false);if($.isArray(response.error)){switch(response.error[0]){case"toomanyimages":var msg=vBulletin.phrase.get("toomanyimages",response.error[1],response.error[2]);break;default:$.each(response.error,function(index,value){response.error[index]=vBulletin.phrase.get(value)});var msg=response.error.join("<br />")}}else{var msg=vBulletin.phrase.get(response.error)}openAlertDialog({title:vBulletin.phrase.get("edit_conversation"),message:msg,iconType:"error"});return }var contentType=$(".edit-conversation-container form",container).data("content-type");var ret=vBulletin.triggerHandler.apply($form.get(0),["afterSave",$(document),response]);if(ret===false){$("body").trigger(contentType+"_editform_onunload",[container]);window.vBulletin.loadingIndicator.hide();return }$form.closest(".conversation-reply-slideout").addClass("h-hide");var page=pageData;page["posts-perpage"]=vBulletin.conversation.POSTS_PER_PAGE;if(view=="thread"){page["comments-perpage"]=vBulletin.conversation.COMMENTS_PER_PAGE}var xhr=$.post(vBulletin.getAjaxBaseurl()+"/create-content/loadnode",{nodeid:nodeid,view:view,page:page,index:index,type:conversationType},function(data){if(data.error){openAlertDialog({title:vBulletin.phrase.get("conversation"),message:vBulletin.phrase.get(data.error),iconType:"error"})}else{var $updatedItem=$(data.template);$("body").trigger(contentType+"_editform_onunload",[container]);if(filterInstance&&filterInstance.isFilterSelected("conversations_on")){filterInstance.toggleNewConversations(true)}self.closest(".list-item").replaceWith($updatedItem);$("body").trigger(contentType+"_newcontent_onload",[$updatedItem]);var nodeId=$updatedItem.attr("data-node-id");if($updatedItem.hasClass("conversation-starter")){var updatedTitle=$(".post-title",$updatedItem).first().text();document.title=updatedTitle+" - "+vBulletin.options.get("bbtitle");$(".page-title-widget .widget-header .module-title").text(updatedTitle)}vBulletin.animateScrollTop($updatedItem.offset().top,{duration:"slow"})}},"json").error(function(){openAlertDialog({title:vBulletin.phrase.get("conversation"),message:vBulletin.phrase.get("error_loading_post"),iconType:"error"})}).complete(function(){window.vBulletin.loadingIndicator.hide()})};$.post(vBulletin.getAjaxBaseurl()+"/create-content/loadeditor",{nodeid:nodeid,type:conversationType,view:view,isAjaxTemplateRender:true},function(template){if(template.error){openAlertDialog({title:vBulletin.phrase.get("edit_conversation"),message:vBulletin.phrase.get(template.error),iconType:"error"})}else{var activateEditModeCallback=function(){container.addClass("edit-post content-entry-box").find(".edit-conversation-container").show();window.vBulletin.loadingIndicator.hide();var $container=$("> .edit-conversation-container",container),$attachList=$container.find(".js-attach-list");vBulletin.upload.initializePhotoUpload(container);if($attachList.data("attach-count")>0){$container.find(".b-toolbar__item").filter(function(){return $(this).data("panel")=="b-content-entry-panel__content--attachment"}).click()}};$("> .edit-conversation-container",container).hide().html(template);var contentType=$(".edit-conversation-container form",container).data("content-type");$(window).off("beforeunload.editPost").on("beforeunload.editPost",function(){return vBulletin.phrase.get("onbeforeunload_message_while_editing_post")});$("body").trigger(contentType+"_editform_onload",[container,activateEditModeCallback]);$(".edit-conversation-container input[placeholder], .edit-conversation-container textarea[placeholder]",container).placeholder();var $tagEditorBox=$(".list-item[data-node-id={0}] .tag-editor-container .tag-input".format(nodeid));if($tagEditorBox.length>0){var tagEditor=new vBulletin.tagEditor.instance($tagEditorBox.selector)}$("form",container).ajaxForm({dataType:"json",success:saveEditCallback,beforeSerialize:function($form){$form.trigger("beforeSave");var ret=$("body").triggerHandler(contentType+"_editform_onbeforeserialize",[$form]);return(ret===false)?false:true},beforeSubmit:function(formData,form,options){var ret=vBulletin.contentEntryBox.validateForm.apply(form,[options]);if(ret===false){return false}$(window).off("beforeunload.editPost");window.vBulletin.loadingIndicator.show();return true}})}},"json").error(function(xhr,textStatus,errorThrown){openAlertDialog({title:vBulletin.phrase.get("edit_conversation"),message:"HTTP {0} - {1}".format(xhr.status,errorThrown),iconType:"error"})}).complete(function(xhr,textStatus,errorThrown){window.vBulletin.loadingIndicator.hide()})};vBulletin.conversation.votePost=function(e){var nodeid=$(this).closest(".list-item").attr("data-node-id");$(".list-item[data-node-id="+nodeid+"] .voteCtrl").addClass("h-disabled");$("body").css("cursor","wait");if(!$(this).hasClass("voted")){$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/reputation/vote",type:"post",data:{nodeid:nodeid},dataType:"json",success:function(response){if(response){if(response.errors){openAlertDialog({title:vBulletin.phrase.get("error_saving_vote"),message:vBulletin.phrase.get(response.errors[0]),iconType:"error"});$(".list-item[data-node-id="+nodeid+"] .voteCtrl").removeClass("h-disabled")}else{$(".list-item[data-node-id="+response.nodeid+"] .votecount").html(response.votes);$(".list-item[data-node-id="+nodeid+"] .voteCtrl").addClass("voted").removeClass("h-disabled").find(".label").text(vBulletin.phrase.get("unvote_cap")).end()}}},complete:function(){$("body").css("cursor","default")}})}else{$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/reputation/unvote",type:"post",data:{nodeid:nodeid},dataType:"json",success:function(response){if(response){if(response.errors){openAlertDialog({title:vBulletin.phrase.get("error_saving_vote"),message:vBulletin.phrase.get(response.errors[0]),iconType:"error"});$(".list-item[data-node-id="+nodeid+"] .voteCtrl").removeClass("h-disabled")}else{$(".list-item[data-node-id="+response.nodeid+"] .votecount").html(response.votes);$(".list-item[data-node-id="+nodeid+"] .voteCtrl").removeClass("voted").removeClass("h-disabled").find(".label").text(vBulletin.phrase.get("vote_cap")).end()}}},complete:function(){$("body").css("cursor","default")}})}};vBulletin.conversation.showWhoVoted=function(e){var self=$(this);if($(this).hasClass("novotepopup")){return }var nodeid=self.closest(".list-item").attr("data-node-id");self.qtip({content:{title:{text:vBulletin.phrase.get("people_who_liked"),button:true},text:vBulletin.phrase.get("loading")+"...",ajax:{url:vBulletin.getAjaxBaseurl()+"/ajax/api/reputation/fetchWhovoted",type:"POST",data:{nodeid:nodeid},dataType:"json",once:false,success:function(data,status){if(data.errors){this.set("content.text",data.errors[0][0])}else{if(data.length<1){this.set("content.text",vBulletin.phrase.get("no_one_voted"))}else{var html="<ul>";for(x in data){var profileurl=pageData.baseurl+data[x].profileurl,avatarurl;if(!data[x].avatarurl){avatarurl=pageData.baseurl_core+"/image.php?u="+data[x].userid+"&type=profile"}else{avatarurl=pageData.baseurl_core+"/"+data[x].avatarurl}var img=$("<img>").attr("src",avatarurl).attr("alt",data[x].username),avatar=$("<a>").attr("href",profileurl).addClass("avatar"),username=$("<a>").attr("href",profileurl).addClass("username").html(data[x].musername),li=$("<li>"),usertitle=$("<div>").addClass("usertitle").html(data[x].usertitle);avatar.append(img);li.append(avatar);li.append(username);li.append(usertitle);html+=$("<div>").append(li).html()}html+="</ul>";this.set("content.text",html)}}},error:function(jqXHR,textStatus,errorThrown){this.set("content.text","failed to load.")}}},position:{my:"left top",at:"right top",viewport:$(window)},show:{event:"click"},hide:{event:"unfocus",fixed:true},style:{classes:"ui-tooltip-shadow ui-tooltip-light ui-tooltip-whovoted"}});self.qtip("api").show()};vBulletin.conversation.processPostContent=function($conversationList){$conversationList.css("border-bottom","").filter(".stream-view.activity-view").find(".list-item-poll form.poll").each(function(index,form){if($(this).is(":visible")&&$(".view-less-ctrl",this).hasClass("h-hide")){vBulletin.conversation.limitVisiblePollOptionsInAPost(this,3)}})};vBulletin.conversation.limitVisiblePollOptionsInAPost=function($pollForm,maxLines){if(typeof maxLines=="undefined"){maxLines=3}var lineCount=0;var $pollOptionItems=$("ul.poll li",$pollForm);var lh=parseInt($pollOptionItems.css("line-height"),10);$pollOptionItems.each(function(index){$(this).removeClass("h-hide");var h=$(this).height();lineCount+=h/lh;if(lineCount>maxLines){$(this).addClass("h-hide")}else{$(this).css("display","")}});if(lineCount>3){$(".view-more-ctrl",$pollForm).removeClass("h-hide").next(".action-buttons").addClass("h-hide").next(".view-less-ctrl").addClass("h-hide")}else{$(".view-more-ctrl",$pollForm).addClass("h-hide").next(".action-buttons").removeClass("h-hide").next(".view-less-ctrl").addClass("h-hide")}};vBulletin.conversation.bindEditFormEventHandlers=function(contentType){contentType=(contentType)?contentType.toLowerCase():"";if($.inArray(contentType,["text","gallery","video","poll","link","comment"])!=-1||contentType=="all"){var initializeEditor=function($container,activateEditModeCallback){if(typeof activateEditModeCallback=="function"){console.log("Edit mode: initializeEditor");var $bareEditor=$container.find(".js-editor");if($bareEditor.length>0){vBulletin.ckeditor.initEditor($bareEditor,{success:function(ckeditorId){if(typeof activateEditModeCallback=="function"){activateEditModeCallback();vBulletin.contentEntryBox.afterPanelChange($container);vBulletin.ckeditor.initEditorComponents($container);this.setData($bareEditor.prev(".js-editor-parsed-text").html());this.focus()}},error:function(ckeditorId){if(typeof activateEditModeCallback=="function"){activateEditModeCallback()}$bareEditor.prop("disabled",false).removeClass("ckeditor-load-on-focus").closest(".js-content-entry").addClass("b-content-entry--no-ckeditor")},hideLoadingDialog:false})}else{if(typeof activateEditModeCallback=="function"){activateEditModeCallback();$container.closest(".conversation-comments-wrapper").find("> .action-buttons").hide();$bareEditor.focus()}}}};var destroyEditor=function($container){var $bareEditor=$container.find(".js-editor");if($bareEditor.length>0){var editorId=$bareEditor.attr("id");if(vBulletin.ckeditor.editorExists(editorId)){vBulletin.ckeditor.destroyEditor(editorId)}}else{$container.closest(".conversation-comments-wrapper").find("> .action-buttons").show()}};var bindTextEditFormEventHandlers=function(){$("body").off("text_editform_onload").on("text_editform_onload",function(e,$container,activateEditModeCallback){initializeEditor($container,activateEditModeCallback)}).off("text_editform_onunload").on("text_editform_onunload",function(e,$container){destroyEditor($container)}).off("text_newcontent_onload").on("text_newcontent_onload",function(e,$container){if($container.closest(".conversation-list.stream-view.activity-view").length>0){vBulletin.truncatePostContent($container)}})};var bindCommentEditFormEventHandlers=function(){$("body").off("comment_editform_onload").on("comment_editform_onload",function(e,$container,activateEditModeCallback){if(typeof activateEditModeCallback=="function"){activateEditModeCallback();$(".js-editor",$container).focus().filter(".autogrow").elastic().off("blur.elastic")}}).off("comment_editform_onunload").on("comment_editform_onunload",function(e,$container){})};var bindPollEditFormEventHandlers=function(){$("body").off("poll_editform_onload").on("poll_editform_onload",function(e,$container,activateEditModeCallback){initializeEditor($container,activateEditModeCallback);$(".js-datepicker",$container).not(".hasDatePicker").datetimepicker({showOn:"both",buttonImage:pageData.baseurl+"/images/calendar-blue.png",buttonImageOnly:true,ampm:true})}).off("poll_editform_onunload").on("poll_editform_onunload",function(e,$container){destroyEditor($container)}).off("poll_newcontent_onload").on("poll_newcontent_onload",function(e,$container){if($container.closest(".conversation-list.stream-view.activity-view").length>0){vBulletin.truncatePostContent($container);vBulletin.conversation.limitVisiblePollOptionsInAPost($("form.poll",$container),3)}})};var bindGalleryEditFormEventHandlers=function(){$("body").off("gallery_editform_onload").on("gallery_editform_onload",function(e,$container,activateEditModeCallback){$('.b-toolbar__item[data-panel="b-content-entry-panel__content--gallery"]',$container).trigger("click");initializeEditor($container,function(){if(typeof activateEditModeCallback=="function"){activateEditModeCallback()}vBulletin.upload.initializePhotoUpload($container)})}).off("gallery_editform_onunload").on("gallery_editform_onunload",function(e,$container){destroyEditor($container)}).off("gallery_editform_onbeforeserialize").on("gallery_editform_onbeforeserialize",function(e,$form){$form.find(".caption-box").each(function(){var $input=$(this);if($input.hasClass("placeholder")&&$input.val()==$input.attr("placeholder")){$input.val("")}});return true}).off("gallery_newcontent_onload").on("gallery_newcontent_onload",function(e,$container){if($container.closest(".conversation-list.stream-view.activity-view").length>0){vBulletin.truncatePostContent($container)}})};var bindVideoEditFormEventHandlers=function(){$("body").off("video_editform_onload").on("video_editform_onload",function(e,$container,activateEditModeCallback){$('.b-toolbar__item[data-panel="b-content-entry-panel__content--video"]',$container).trigger("click");initializeEditor($container,function(){if(typeof activateEditModeCallback=="function"){activateEditModeCallback()}attachLinkContainerEvents($(".b-content-entry-panel__content--video",$container),"video")});$(".js-attach-button",$container).on("click",function(e){var self=$(this);e.preventDefault();var $panel=self.closest(".b-content-entry-panel__content--video");var $urlBox=$(".b-link-input__url",$panel);var url=$.trim($urlBox.val());if(!url){openAlertDialog({title:vBulletin.phrase.get("attach_video"),message:vBulletin.phrase.get("please_enter_video_url"),iconType:"warning",onAfterClose:function(){$urlBox.focus()}});return false}self.prop("disabled",true);$(".js-button-group .b-button",$panel).prop("disabled",true);$("body").css("cursor","wait");$.post(vBulletin.getAjaxBaseurl()+"/link/getlinkdata",{url:url,isAjaxTemplateRender:true},function(data){if(data.error){openAlertDialog({title:vBulletin.phrase.get("attach_video"),message:vBulletin.phrase.get(data.error),iconType:"warning",onAfterClose:function(){$urlBox.focus()}})}else{$template=$(data);$panel.find(".js-panel-content").append($template);attachLinkContainerEvents($panel,"video");$template.fadeIn("slow",function(){$urlBox.val("");$(".b-link-input",$panel).addClass("h-hide")})}},"json").error(function(xhr,statusText,errorThrown){openAlertDialog({title:vBulletin.phrase.get("attach_video"),message:"HTTP {0} - {1}".format(xhr.status,errorThrown),iconType:"error"})}).complete(function(){$("body").css("cursor","default");self.prop("disabled",false);$(".js-button-group .b-button",$panel).prop("disabled",false)})})}).off("video_editform_onunload").on("video_editform_onunload",function(e,$container){destroyEditor($container)}).off("video_newcontent_onload").on("video_newcontent_onload",function(e,$container){if($container.closest(".conversation-list.stream-view.activity-view").length>0){vBulletin.truncatePostContent($container)}})};var bindLinkEditFormEventHandlers=function(){$("body").off("link_editform_onload").on("link_editform_onload",function(e,$container,activateEditModeCallback){$('.b-toolbar__item[data-panel="b-content-entry-panel__content--link"]',$container).trigger("click");initializeEditor($container,function(){if(typeof activateEditModeCallback=="function"){activateEditModeCallback()}attachLinkContainerEvents($(".b-content-entry-panel__content--link",$container),"link")});$(".js-attach-button",$container).on("click",function(e){var self=$(this);e.preventDefault();var $panel=self.closest(".b-content-entry-panel__content--link");var $urlBox=$(".b-link-input__url",$panel);var url=$.trim($urlBox.val());if(!url){openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("please_enter_a_valid_url_and_click_attach"),iconType:"warning",onAfterClose:function(){$urlBox.focus()}});return false}if(!url.match(/^https?:\/\//)){url="http://"+url;$urlBox.val(url)}self.prop("disabled",true);$(".js-button-group .b-button",$panel).prop("disabled",true);$("body").css("cursor","wait");$.post(vBulletin.getAjaxBaseurl()+"/link/getlinkdata",{url:url,isAjaxTemplateRender:true},function(data){if(data.error){openAlertDialog({title:vBulletin.phrase.get("attach_link"),message:vBulletin.phrase.get(data.error),iconType:"warning",onAfterClose:function(){$urlBox.focus()}})}else{var $template=$(data);$template.find("img").error(function(){$(this).closest("li").remove()});$panel.find(".js-panel-content").append($template);attachLinkContainerEvents($panel,"link");$template.fadeIn("slow",function(){$urlBox.val("");$(".b-link-input",$panel).addClass("h-hide")})}},"json").error(function(xhr,statusText,errorThrown){openAlertDialog({title:vBulletin.phrase.get("attach_link"),message:"HTTP {0} - {1}".format(xhr.status,errorThrown),iconType:"error"})}).complete(function(){$("body").css("cursor","default");self.prop("disabled",false);$(".js-button-group .b-button",$panel).prop("disabled",false)})})}).off("link_editform_onunload").on("link_editform_onunload",function(e,$container){destroyEditor($container)}).off("link_newcontent_onload").on("link_newcontent_onload",function(e,$container){if($container.closest(".conversation-list.stream-view.activity-view").length>0){vBulletin.truncatePostContent($container)}}).off("link_savepost_success").on("link_savepost_success",function(e,$container){$(".b-link-input",$container).removeClass("h-hide-imp")})};var attachLinkContainerEvents=function($panel,contentType){$(".b-link-content__urlinfo .js-link-edit",$panel).on("click",function(e){e.preventDefault();var $parent=$(this).parent().parent();$parent.addClass("b-link-content__urlinfo-meta--edit-mode");$(".js-link-textbox",$parent).val($.trim($(".b-link-content__urlinfo-text",$parent).text())).trigger("focus");$(".js-link-save",$parent).on("click",function(e){e.preventDefault();$(".b-link-content__urlinfo-text",$parent).text($(".js-link-textbox",$parent).val());$parent.removeClass("b-link-content__urlinfo-meta--edit-mode")})});$(".js-link-remove",$panel).on("click",function(e){e.preventDefault();$(this).closest(".b-content-entry-panel__content").find(".b-link-input").removeClass("h-hide");$(this).closest(".js-panel-content").empty();$(".b-link-input",$panel).removeClass("h-hide")});if(contentType=="link"){$(".js-preview-checkbox",$panel).off("click").on("click",function(){$(".b-link-content__thumbnail",$panel)[this.checked?"addClass":"removeClass"]("h-hide")});var thumbnailCount=$(".b-link-thumbnail-list__item",$panel).length;$(".b-link-thumbnail-list",$panel).jcarousel({scroll:1,wrap:null,size:thumbnailCount,rtl:$("html").attr("dir")=="rtl",buttonNextCallback:function(carousel,button,enabled){if(enabled){$(".b-thumbnail-nav .b-thumbnail-nav__next-arrow",$panel).removeClass("b-icon__arrow-right-m--disabled").addClass("b-icon__arrow-right-m--default")}else{$(".b-thumbnail-nav .b-thumbnail-nav__next-arrow",$panel).addClass("b-icon__arrow-right-m--disabled").removeClass("b-icon__arrow-right-m--default")}},buttonPrevCallback:function(carousel,button,enabled){if(enabled){$(".b-thumbnail-nav .b-thumbnail-nav__prev-arrow",$panel).removeClass("b-icon__arrow-left-m--disabled").addClass("b-icon__arrow-left-m--default")}else{$(".b-thumbnail-nav .b-thumbnail-nav__prev-arrow",$panel).addClass("b-icon__arrow-left-m--disabled").removeClass("b-icon__arrow-left-m--default")}},initCallback:function(carousel,state){if(state=="init"&&thumbnailCount>0){$(".b-thumbnail-nav .b-thumbnail-nav__counter",$panel).html("1/"+thumbnailCount);$(".b-thumbnail-nav .b-thumbnail-nav__prev-arrow",$panel).off("click").on("click",function(){if(!$(this).hasClass("b-icon__arrow-left-m--disabled")){$(".jcarousel-container .jcarousel-prev",$panel).trigger("click")}});$(".b-thumbnail-nav .b-thumbnail-nav__next-arrow",$panel).off("click").on("click",function(){if(!$(this).hasClass("b-icon__arrow-right-m--disabled")){$(".jcarousel-container .jcarousel-next",$panel).trigger("click")}})}},itemVisibleInCallback:function(carousel,item,index,state){if(state=="init"){return false}$(".b-thumbnail-nav .b-thumbnail-nav__counter",$panel).html(index+"/"+thumbnailCount);$('input[type="radio"]',item).prop("checked",true)},itemFallbackDimension:90})}};switch(contentType){case"text":bindTextEditFormEventHandlers();break;case"comment":bindCommentEditFormEventHandlers();break;case"poll":bindPollEditFormEventHandlers();break;case"gallery":bindGalleryEditFormEventHandlers();break;case"video":bindVideoEditFormEventHandlers();break;case"link":bindLinkEditFormEventHandlers();break;case"all":bindTextEditFormEventHandlers();bindCommentEditFormEventHandlers();bindPollEditFormEventHandlers();bindGalleryEditFormEventHandlers();bindVideoEditFormEventHandlers();bindLinkEditFormEventHandlers();break}}};vBulletin.isScrolledIntoView=function(elem,elemRelativePos){var isPlainObject=false;if($.isPlainObject(elemRelativePos)&&(elemRelativePos).toString()=="[object Object]"){isPlainObject=true;elemRelativePos.top=0;elemRelativePos.bottom=0}elem=(elem instanceof $)?elem:$(elem);if(elem.length==0){return false}var docViewTop=$(window).scrollTop();var docViewBottom=docViewTop+$(window).height();var elemTop=elem.offset().top;var elemBottom=elemTop+elem.outerHeight();var elemRelativeTop=elemTop-docViewTop;var elemRelativeBottom=docViewBottom-elemBottom;if(isPlainObject){elemRelativePos.top=elemRelativeTop;elemRelativePos.bottom=elemRelativeBottom}return(elemRelativeTop>=0&&elemRelativeBottom>=0)};vBulletin.scrollToFixed=function(userOptions){var self=this;var options={element:$(),fixedAt:"top",limit:0,triggerOnload:true,zIndex:99};var namespace=("scrollToFixed"+Math.random()).replace(".","");function init(userOptions){options=$.extend({},options,userOptions);if(options.element){options.element=(options.element instanceof $)?options.element:$(options.element);if(options.element.length>0){var $el=options.element;if($.inArray(options.fixedAt,["top","bottom"])){options.fixedAt="top"}var fixedClass="scrolltofixed";var origLayout={width:$el.width(),offset:$el.offset(),"margin-top":parseInt($el.css("margin-top"),10),"margin-bottom":parseInt($el.css("margin-bottom"),10),cssPosition:$el.css("position"),coordinates:{left:$el.css("left"),top:$el.css("top"),right:$el.css("right"),bottom:$el.css("bottom")}};if(typeof $Rx!=="undefined"){var scrollToFixedBreakPoint=($Rx&&$Rx.scrollToFixedBreakPoint)?$Rx.scrollToFixedBreakPoint:0;var $filler=$("<div />");if($("#vb-page-body").width()>scrollToFixedBreakPoint){$filler.addClass("scrolltofixed-filler").hide().insertAfter($el)}}$el.data("origOffsetTop",origLayout.offset.top);$el.css("z-index",options.zIndex);$el.data("object-instance",self);var $w=$(window).off("scroll."+namespace).on("scroll."+namespace,function(){if($el.is(":hidden")){return }var scrollTop=$(this).scrollTop();if(options.limit>0&&scrollTop>options.limit&&$el.hasClass(fixedClass)){$el.removeClass(fixedClass).css({position:"absolute",left:"auto",right:"auto",top:"auto",bottom:"auto",width:origLayout.width})}else{if((options.limit>0&&scrollTop<options.limit&&scrollTop>origLayout.offset.top&&!$el.hasClass(fixedClass))||(options.limit<=0&&scrollTop>origLayout.offset.top&&!$el.hasClass(fixedClass))){$filler.css({display:$el.css("display"),width:$el.outerWidth(true),height:$el.outerHeight(true),"float":$el.css("float")});if($("#vb-page-body").width()>scrollToFixedBreakPoint){$el.addClass(fixedClass).width(origLayout.width).css({left:origLayout.offset.left,right:"auto",width:origLayout.width,top:(options.fixedAt=="top")?0:"auto",bottom:(options.fixedAt=="bottom")?0:"auto",position:""})}var margin=origLayout["margin-"+options.fixedAt];if(margin){var props={};props[options.fixedAt]=-margin+"px";$el.animate(props,"fast")}}else{if(scrollTop<=origLayout.offset.top&&$el.hasClass(fixedClass)){$filler.hide();$el.removeClass(fixedClass).css({position:"",width:"",left:"",top:"",right:"",bottom:""})}}}}).off("resize."+namespace).on("resize."+namespace,function(){$el.removeClass(fixedClass).width("auto").css({position:"",left:""});origLayout.width=$el.width();origLayout.offset=$el.offset();$(this).trigger("scroll."+namespace)});if(options.triggerOnload){$w.trigger("scroll."+namespace)}}}}this.updateLimit=function(limit){if(!isNaN(Number(limit))){options.limit=limit;$(window).trigger("scroll."+namespace)}};this.addLimit=function(limitToAdd){if(!isNaN(Number(limitToAdd))){options.limit+=limitToAdd;$(window).trigger("scroll."+namespace)}};this.reset=function(options){init(options)};init(userOptions)};vBulletin.scrollToAnchor=function(hash){var $anchor=$(hash);console.log("vBulletin.scrollToAnchor() hash: {0}, found: {1}".format(hash,$anchor.length));if($anchor.length>0){var offsetTop=$anchor.show().offset().top-2;$anchor.hide();var $root=$("html,body");var floatingTopBar=$(".scrolltofixed-floating.scrolltofixed-top");var starter=false;if(floatingTopBar.length>0){if($(".list-container .list-item:first a.anchor"+hash).length==1){if(floatingTopBar.hasClass("scrolltofixed")){floatingTopBar.removeClass("scrolltofixed")}offsetTop=floatingTopBar.offset().top;starter=true}else{if(floatingTopBar.hasClass("scrolltofixed")){offsetTop-=floatingTopBar.outerHeight()}}}$root.animate({scrollTop:offsetTop},1000,function(){if(!starter){var offsetTop=$anchor.show().offset().top;$anchor.hide();var floatingTopBar=$(".scrolltofixed-floating.scrolltofixed-top.scrolltofixed");offsetTop-=(floatingTopBar.length>0)?floatingTopBar.outerHeight():0;$root.animate({scrollTop:offsetTop},"slow")}$("a.anchor").show()});return false}$("a.anchor").show();return true};if(location.hash){vBulletin.scrollToAnchor(location.hash)}vBulletin.animateScrollTop=function(offsetTop,animationOptions){console.log("vBulletin.animateScrollTop({0})".format(offsetTop));var $floatingTopBar=$(".scrolltofixed-floating.scrolltofixed-top");if($floatingTopBar.length>0){var offsetTopFloatingBar=$floatingTopBar.data("origOffsetTop")||$floatingTopBar.offset().top;if(!$floatingTopBar.hasClass("scrolltofixed")&&offsetTopFloatingBar<offsetTop){offsetTop-=$floatingTopBar.outerHeight(true)}if(offsetTopFloatingBar<offsetTop){offsetTop-=$floatingTopBar.outerHeight()}}$("html, body").animate({scrollTop:offsetTop},animationOptions)};vBulletin.subscribe=function(button){if($(button).hasClass("isSubscribed")||$(button).hasClass("is-pending")){return true}var itemId=parseInt($(button).attr("data-node-id"),10);var params={};var request="";if($(button).hasClass("is-topic")){request="/ajax/api/follow/add";params.follower=itemId;params.type="follow_contents"}else{request="/ajax/api/node/requestChannel";params.channelid=itemId;params.recipient=parseInt($(button).attr("data-owner-id"),10);params.requestType=$(button).hasClass("is-blog-channel")?"member":"sg_subscriber"}$.ajax({url:pageData.baseurl+request,data:params,type:"POST",dataType:"json",success:function(response){if(!isNaN(response)&&response==1){$(button).children(".button-text-primary").text(vBulletin.phrase.get("following"));$(button).addClass("isSubscribed special").removeClass("secondary");location.reload()}else{if(!isNaN(response)&&response>1){$(button).children(".button-text-primary").text(vBulletin.phrase.get("following_pending"));$(button).addClass("is-pending special").removeClass("secondary");location.reload()}else{if(response.errors){openAlertDialog({title:vBulletin.phrase.get("follow"),message:vBulletin.phrase.get(response.errors[0][0]),iconType:"error"})}else{openAlertDialog({title:vBulletin.phrase.get("follow"),message:vBulletin.phrase.get("follow_error"),iconType:"error"})}}}},error:function(){openAlertDialog({title:vBulletin.phrase.get("follow"),message:vBulletin.phrase.get("follow_error"),iconType:"error"})}})};vBulletin.join=function(button){var itemId=parseInt($(button).attr("data-node-id"),10);var recipientId=parseInt($(button).attr("data-owner-id"),10);$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/node/requestChannel",data:({channelid:itemId,recipient:recipientId,requestType:"sg_member"}),type:"POST",dataType:"json",success:function(response){if(response.errors){openAlertDialog({title:vBulletin.phrase.get("join"),message:vBulletin.phrase.get(response.errors[0]),iconType:"error"})}else{if(response===true){$(button).children(".button-text-primary").text(vBulletin.phrase.get("joined"));$(button).addClass("has-joined special").removeClass("secondary");location.reload()}else{if(!isNaN(response)){$(button).children(".button-text-primary").text(vBulletin.phrase.get("following_pending"));$(button).addClass("is-pending special").removeClass("secondary")}}}},error:function(){openAlertDialog({title:vBulletin.phrase.get("join"),message:vBulletin.phrase.get("join_error"),iconType:"error"})}})};vBulletin.leave=function(button){var itemId=parseInt($(button).attr("data-node-id"),10);$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/blog/leaveChannel",data:({channelId:itemId}),type:"POST",dataType:"json",success:function(response){if(response.errors){openAlertDialog({title:vBulletin.phrase.get("leave"),message:vBulletin.phrase.get(response.errors[0]),iconType:"error"})}else{if(response===true){var $button=$(button);if($button.hasClass("follow-btn")){$button.children(".button-text-primary").text(vBulletin.phrase.get("follow"));$button.removeClass("isSubscribed unfollow-btn");$button.addClass("special")}else{$button.children(".button-text-primary").text(vBulletin.phrase.get("join"));$button.removeClass("has-joined special")}location.reload()}else{openAlertDialog({title:vBulletin.phrase.get("leave"),message:vBulletin.phrase.get("invalid_server_response_please_try_again"),iconType:"error"})}}},error:function(){openAlertDialog({title:vBulletin.phrase.get("leave"),message:vBulletin.phrase.get("invalid_server_response_please_try_again"),iconType:"error"})}})};vBulletin.unsubscribe=function(button){var itemId=$(button).attr("data-node-id");$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/follow/delete",data:({follower:itemId,type:"follow_contents"}),type:"POST",dataType:"json",success:function(response){if(response==1){$(button).removeClass("isSubscribed unfollow-btn special").addClass("secondary").children(".button-text-primary").text(vBulletin.phrase.get("follow"));location.reload()}else{if(response.errors){openAlertDialog({title:vBulletin.phrase.get("following_remove"),message:vBulletin.phrase.get(response.errors[0][0]),iconType:"error"})}else{openAlertDialog({title:vBulletin.phrase.get("follow"),message:vBulletin.phrase.get("unfollow_error"),iconType:"error"})}}},error:function(){openAlertDialog({title:vBulletin.phrase.get("follow"),message:vBulletin.phrase.get("unfollow_error"),iconType:"error"})}})};vBulletin.getUnsubscribeOverlay=function(button){var nodeId="";var unfollowPanel=$(button).closest(".list-item").find("ul.unfollow_panel").filter(function(){var temp=parseInt($(this).attr("data-node-id"),10);if(typeof temp=="number"){nodeId=temp;return true}});var children=unfollowPanel.children();var isFollowingMember,isFollowingContent,isFollowingChannel=false;var unsubscribeParams="";$.each(children,function(index,value){if($(value).hasClass("unfollow_content")){isFollowingContent=$(value).attr("data-item-id")}else{if($(value).hasClass("unfollow_member")){isFollowingMember=$(value).attr("data-item-id")}else{if($(value).hasClass("unfollow_channel")){isFollowingChannel=$(value).attr("data-item-id")}}}});if(isFollowingContent){unsubscribeParams+="&content="+isFollowingContent}if(isFollowingMember){unsubscribeParams+="&member="+isFollowingMember}if(isFollowingChannel){unsubscribeParams+="&channel="+isFollowingChannel}if(nodeId){$.ajax({url:vBulletin.getAjaxBaseurl()+"/profile/getUnsubscribeOverlay?userId="+pageData.userid+unsubscribeParams+"&nodeId="+nodeId,success:function(response){var unsubscribeOverlay=$(".unsubscribe-overlay-container");if(unsubscribeOverlay){unsubscribeOverlay.html(response);unsubscribeOverlay.children(".unsubscribe-overlay").dialog({title:vBulletin.phrase.get("following_remove"),autoOpen:false,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,width:450,dialogClass:"dialog-container unsubscribe-dialog-container dialog-box"}).dialog("open")}},error:function(){openAlertDialog({title:vBulletin.phrase.get("following_remove"),message:vBulletin.phrase.get("unable_to_contact_server_please_try_again"),iconType:"error"})}})}};vBulletin.removeUnsubscribeOptions=function(button,subscribedFilter){var unsubscribeOverlay=$(button).parents(".unsubscribe-overlay");var nodeId=parseInt(unsubscribeOverlay.attr("data-node-id"),10);if(typeof nodeId!="number"){return false}var unsubscribeOptions=$(unsubscribeOverlay).children(".unsubscribe-options");var unsubscribeItems=[];if(($(unsubscribeOptions).find("li #"+nodeId+"-unsubscribeAll:checkbox:checked")).length===1){$.each($(unsubscribeOptions).find("li :checkbox[name=unsubscribeItems]"),function(key,val){var type=$(val).attr("data-type");var itemId=parseInt($(val).attr("data-item-id"),10);if(itemId&&typeof itemId=="number"){unsubscribeItems.push({type:type,itemId:itemId})}})}else{$.each($(unsubscribeOptions).find("li :checkbox[name=unsubscribeItems]:checked"),function(key,val){var type=$(val).attr("data-type");var itemId=parseInt($(val).attr("data-item-id"),10);if(itemId&&typeof itemId=="number"){unsubscribeItems.push({type:type,itemId:itemId})}})}if(unsubscribeItems.length>0){$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/follow/unsubscribeItems",data:({unsubscribeItems:unsubscribeItems}),type:"POST",dataType:"json",success:function(response){if(response===true){$(unsubscribeOverlay).dialog("close").remove();subscribedFilter.updatePageNumber(1).applyFilters(false)}else{if(response.errors!=undefined){openAlertDialog({title:vBulletin.phrase.get("profile_guser"),message:vBulletin.phrase.get("unable_to_contact_server_please_try_again"),iconType:"error"})}}},error:function(){openAlertDialog({title:vBulletin.phrase.get("profile_guser"),message:vBulletin.phrase.get("unable_to_contact_server_please_try_again"),iconType:"error"})}})}else{openAlertDialog({title:vBulletin.phrase.get("profile_guser"),message:vBulletin.phrase.get("unsubscribe_overlay_error"),iconType:"error"})}};vBulletin.truncatePostContent=function($context){$context=($context instanceof $)?$context:$($context);if($context.selector==""){$context=$("body")}$(".poll-desc.ellipsis, .message-body.ellipsis",$context).each(function(){var $content=$(this);truncatedHeight=$content.height();$content.removeClass("ellipsis");var actualHeight=$content.height();$content.addClass("ellipsis");if(actualHeight>truncatedHeight){$content.closest(".list-item-body").find(".post-links").removeClass("hide-see-link").find(".see-link").off("click").on("click",function(){var $self=$(this);if($self.hasClass("more")){$content.removeClass("ellipsis")}else{$content.addClass("ellipsis")}$self.toggleClass("more less");var currentText=$self.text();$self.text($self.data("toggle-text")).data("toggle-text",currentText);return false})}});$(".list-item .see-link.more").each(function($e){var container=$(this).closest(".list-item");var contentBlock=$(container).find(".post-content.restore");if(contentBlock.length>0){var full=false;var loaded=false;var defaultText=$(this).text();var fullText="";var preview=$(contentBlock).html();var linkShowmore=this;$(this).on("click",function(){nodeid=$(container).attr("data-node-id");if(full){$(linkShowmore).text(defaultText);$(contentBlock).html(preview);full=false}else{if(loaded){$(linkShowmore).text(vBulletin.phrase.get("see_less"));full=true;$(contentBlock).html(fullText)}else{if(!loaded&&nodeid){$.ajax({url:vBulletin.getAjaxBaseurl()+"/activity/fetchText",data:{nodeid:nodeid},dataType:"json",complete:function(){},success:function(result){if(result&&!result.error&&result.nodeText){fullText=result.nodeText;if(fullText.length<=preview.length){$(linkShowmore).addClass("ui-helper-hidden");postLink=$(linkShowmore).closest(".post-links").html().replace("<span>|</span>","");$(linkShowmore).closest(".post-links").html(postLink)}else{$(contentBlock).html(result.nodeText);$(linkShowmore).text(vBulletin.phrase.get("see_less"));console.log("loaded content for node "+nodeid);full=true;loaded=true;return false}}},error:function(xhr,statusText,errorThrown){console.log("Attempt to load text for node "+nodeid+" failed:"+errorThrown)}})}}}return false})}})};vBulletin.markreadcheck=function(){if((parseInt(pageData.threadmarking)>0)&&(parseInt(pageData.userid)>0)){return }var lastvisit=$.cookie(pageData.cookie_prefix+"lastvisit");if(parseInt(pageData.userid)>0&&(!lastvisit||pageData.lastvisit>lastvisit)){lastvisit=pageData.lastvisit}var timenow=Math.round(new Date().getTime()/1000),markinglimittime=timenow-vBulletin.options.get("markinglimit")*86400;$(".forum-item").each(function(){var lastcontent=parseInt($(this).attr("data-lastcontent"));var channelview=0;if(lastcontent<=lastvisit){$(this).removeClass("new");return }channelview=vBulletin.cookie.fetchBbarrayCookie("channel_view",$(this).attr("data-channel-id"));channelview=channelview?parseInt(channelview):0;if(lastcontent>channelview){$(this).addClass("new")}else{$(this).removeClass("new")}});$(".subforum-item").each(function(){var lastcontent=parseInt($(this).attr("data-lastcontent"));var channelview=0;if(lastcontent<=lastvisit){$(this).removeClass("new");$(this).find(".icon").removeClass("new");return }channelview=vBulletin.cookie.fetchBbarrayCookie("channel_view",$(this).attr("data-channel-id"));channelview=channelview?parseInt(channelview):0;if(lastcontent>channelview){$(this).addClass("new");$(this).find(".icon").addClass("new")}else{$(this).removeClass("new");$(this).find(".icon").removeClass("new")}});$(".topic-item").each(function(){var lastcontent=parseInt($(this).attr("data-lastcontent"));var topicview=0,channelview=0,checkview=0;if(pageData.userid=="0"){if(lastcontent<=lastvisit){$(this).addClass("read");return }channelview=vBulletin.cookie.fetchBbarrayCookie("channel_view",$(this).attr("data-channel-id"));channelview=channelview?parseInt(channelview):0;topicview=vBulletin.cookie.fetchBbarrayCookie("discussion_view",$(this).attr("data-node-id"));topicview=topicview?parseInt(topicview):0;checkview=Math.max(channelview,topicview)}else{checkview=$(this).attr("data-readtime")?parseInt($(this).attr("data-readtime")):0;channelview=$(this).attr("data-channelreadtime")?parseInt($(this).attr("data-channelreadtime")):0;checkview=Math.max(checkview,channelview,markinglimittime)}if(lastcontent<=checkview||$(this).hasClass("redirect")){$(this).addClass("read")}else{if($(this).find(".topic-wrapper .go-to-first-unread").length==0){var topicUrl=$(this).find(".topic-wrapper .topic-title").attr("href");if(typeof (topicUrl)!="undefined"){topicUrl+=(topicUrl.indexOf("?")==-1?"?":"&amp;")+"goto=newpost";$("<a />").addClass("go-to-first-unread").attr("href",topicUrl).attr("title",vBulletin.phrase.get("go_to_first_new_post")).html("&nbsp;").prependTo($(this).find(".topic-wrapper"));$(this).find(".vb-icon-topic-status").attr("title",vBulletin.phrase.get("new_posts"))}}}})};vBulletin.markchannelsread=function(channelid,callbacks,sender){channelids=[];if(parseInt(channelid)){vBulletin.setChannelRead(channelid,callbacks)}else{if(pageData.channelid&&parseInt(pageData.channelid)&&parseInt(pageData.threadmarking)>0&&parseInt(pageData.userid)>0){vBulletin.setChannelRead(pageData.channelid,callbacks)}else{channels=$(sender).closest(".widget-content").find(".forum-list-container .forum-item");subchannels=$(sender).closest(".widget-content").find(".forum-list-container .subforum-item");result=false;$.each(channels,function(index,channel){channelid=$(channel).attr("data-channel-id");if(parseInt(channelid)){channelids.push(channelid)}});$.each(subchannels,function(index,channel){channelid=$(channel).attr("data-channel-id");if(parseInt(channelid)){channelids.push(channelid)}})}}$.each(channelids,function(index,channelid){if(index>=channelids.length-1){vBulletin.setChannelRead(channelid,callbacks)}else{vBulletin.setChannelRead(channelid,[])}})};vBulletin.setChannelRead=function(channelid,callbacks){var timenow=Math.round(new Date().getTime()/1000);if(pageData.threadmarking=="0"||!parseInt(pageData.userid)){if(channelid==0){$.cookie(pageData.cookie_prefix+"lastvisit",timenow)}else{var channelviews;try{channelviews=$.parseJSON(vBulletin.cookie.convertBbarrayCookie($.cookie(pageData.cookie_prefix+"channel_view")))||{}}catch(e){channelviews={}}channelviews[channelid]=timenow;var cookieoptions={path:pageData.baseurl_path};cookieoptions.expires=365;$.cookie(pageData.cookie_prefix+"channel_view",vBulletin.cookie.convertBbarrayCookie(JSON.stringify(channelviews),"set"),cookieoptions)}if(callbacks.success&&typeof callbacks.success=="function"){callbacks.success()}}else{$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/node/markChannelsRead",data:{nodeid:channelid},type:"POST",dataType:"json",complete:function(){},success:function(result){if(result&&!result.error){}console.log("Channel "+channelid+" is marked read successfully!");if(callbacks.success&&typeof callbacks.success=="function"){callbacks.success(result)}else{console.log("Channel "+channelid+" is marked read failed: "+result.error)}},error:function(xhr,statusText,errorThrown){console.log("Channel "+channelid+" is marked read failed:"+error);openAlertDialog({title:vBulletin.phrase.get("forum"),message:"HTTP {0} - {1}".format(xhr.status,errorThrown),iconType:"error"})}})}return true};vBulletin.ckeditor=vBulletin.ckeditor||{};window.CKEDITOR_BASEPATH=pageData.baseurl+"/js/ckeditor/";vBulletin.ckeditor.requiredScriptsLoaded=false;vBulletin.ckeditor.requiredScriptsLoadFailed=false;vBulletin.ckeditor.requiredScriptLoadingStarted=false;vBulletin.ckeditor.checkEnvironment=function(){var agent=navigator.userAgent.toLowerCase();var opera=window.opera;var env={ie:eval("/*@cc_on!@*/false"),opera:(!!opera&&opera.version),webkit:(agent.indexOf(" applewebkit/")>-1),air:(agent.indexOf(" adobeair/")>-1),mac:(agent.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat"),mobile:(agent.indexOf("mobile")>-1),iOS:/(ipad|iphone|ipod)/.test(agent)};env.gecko=(navigator.product=="Gecko"&&!env.webkit&&!env.opera);if(env.webkit){if(agent.indexOf("chrome")>-1){env.chrome=true}else{env.safari=true}}var version=0;if(env.ie){if(env.quirks||!document.documentMode){version=parseFloat(agent.match(/msie (\d+)/)[1])}else{version=document.documentMode}env.ie9Compat=version==9;env.ie8Compat=version==8;env.ie7Compat=version==7;env.ie6Compat=version<7||env.quirks}if(env.gecko){var geckoRelease=agent.match(/rv:([\d\.]+)/);if(geckoRelease){geckoRelease=geckoRelease[1].split(".");version=geckoRelease[0]*10000+(geckoRelease[1]||0)*100+(geckoRelease[2]||0)*1}}if(env.opera){version=parseFloat(opera.version())}if(env.air){version=parseFloat(agent.match(/ adobeair\/(\d+)/)[1])}if(env.webkit){version=parseFloat(agent.match(/ applewebkit\/(\d+)/)[1])}env.version=version;env.isCompatible=!env.mobile&&((env.ie&&version>6)||(env.gecko&&version>=10801)||(env.opera&&version>=9.5)||(env.air&&version>=1)||(env.webkit&&version>=522)||false);return env.isCompatible};vBulletin.ckeditor.fireCallbacks=function(editorId,options,status,context){if(status=="error"&&typeof options.error=="function"){options.error(editorId)}if(status=="success"&&typeof options.success=="function"){options.success.apply(context,[editorId,context])}if(typeof options.complete=="function"){options.complete(editorId)}};vBulletin.ckeditor.initEditor=function(editorId,options){options=options||{};editorId=vBulletin.ckeditor.verifyEditorId(editorId);console.log("Ckeditor: initEditor({0})".format(editorId));if(!vBulletin.ckeditor.checkEnvironment()){$("#"+editorId).closest(".b-content-entry").find("li[data-panel=b-content-entry-panel__content--toggle-editor]").addClass("h-hide");vBulletin.ckeditor.fireCallbacks(editorId,options,"error");return }if(vBulletin.ckeditor.requiredScriptsLoaded){vBulletin.ckeditor.doInitEditor(editorId,options)}else{vBulletin.ckeditor.loadScripts(editorId,options)}};vBulletin.ckeditor.loadScripts=function(editorId,options,jsloaded){if(vBulletin.ckeditor.requiredScriptLoadingStarted){console.warn("Ckeditor: Trying to load required scripts more than once.");return }vBulletin.ckeditor.requiredScriptLoadingStarted=true;options=options||{};editorId=editorId||"";if(typeof (options.hideLoadingDialog)!=="undefined"&&!options.hideLoadingDialog){vBulletin.ckeditor.showLoadingDialog(editorId)}var fetchScriptError=function(){if(options.showError||!vBulletin.ckeditor.requiredScriptsLoadFailed){openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("error_loading_ckeditor_script"),iconType:"warning"})}vBulletin.loadingIndicator.hide();vBulletin.ckeditor.requiredScriptsLoadFailed=true;vBulletin.ckeditor.fireCallbacks(editorId,options,"error")};var onCkeditorScriptLoad=function(){if(!vBulletin.ckeditor.requiredScriptsLoadFailed){if(typeof jsloaded=="function"){jsloaded()}if(typeof vBulletin.ckeditor.doInitEditor=="function"&&window.CKEDITOR){vBulletin.ckeditor.requiredScriptsLoaded=true;vBulletin.ckeditor.doInitEditor(editorId,options)}else{setTimeout(onCkeditorScriptLoad,10)}}else{vBulletin.ckeditor.fireCallbacks(editorId,options,"error");if(!options.hideLoadingDialog){vBulletin.ckeditor.hideLoadingDialog(editorId)}}};if(typeof vBulletin.ckeditor.doInitEditor!="function"&&!window.CKEDITOR){vBulletin.AJAX({url:vBulletin.getAjaxBaseurl()+"/ajax/render/ckeditor_javascript",success:function(result){var scripts=[];var src_regex=/src="([^"]+)"/g;while(match=src_regex.exec(result)){scripts.push(match[1])}var fetchScript=function(){if(scripts.length>0){console.log("Ckeditor: Calling getScript for: {0}".format(scripts[0]));$.getScript(scripts[0],function(script,textStatus,jqXHR){if(textStatus!="success"){console.warn("Ckeditor: Error loading "+scripts[0]);fetchScriptError();return false}console.log("Ckeditor: Script loaded: "+scripts[0]);scripts.splice(0,1);fetchScript()}).fail(function(jqXHR,errorType,exception){console.warn("Ckeditor: Error loading script: "+errorType+" Exception: "+exception);fetchScriptError()})}else{onCkeditorScriptLoad()}};fetchScript()},error_phrase:"error_fetching_dialog"})}else{onCkeditorScriptLoad()}};vBulletin.ckeditor.editorExists=function(editorId){return false};vBulletin.ckeditor.isEditorEmpty=function(editorId){return true};vBulletin.ckeditor.resetEditor=function(editorId){return false};vBulletin.ckeditor.getEditorContent=function(editorId){editorId=vBulletin.ckeditor.verifyEditorId(editorId);if(!editorId){return false}if(vBulletin.ckeditor.editorExists(editorId)){var ckEditor=vBulletin.ckeditor.getEditor(editorId);if(ckEditor&&ckEditor.getData){return $.trim(ckEditor.getData())}else{return false}}else{return $.trim($("#"+editorId).val())}};vBulletin.ckeditor.focusEditor=function(editorId){editorId=vBulletin.ckeditor.verifyEditorId(editorId);if(!editorId){return }if(vBulletin.ckeditor.editorExists(editorId)){var ckEditor=vBulletin.ckeditor.getEditor(editorId);if(ckEditor){ckEditor.focus()}}else{$("#"+editorId).focus()}};vBulletin.ckeditor.loadingDialogStack={};vBulletin.ckeditor.showLoadingDialog=function(editorId){if((typeof vBulletin.ckeditor.loadingDialogStack[editorId]!="undefined")&&vBulletin.ckeditor.loadingDialogStack[editorId]){return }vBulletin.ckeditor.loadingDialogStack[editorId]=true;var $domElement=$("#"+editorId);if($domElement.length>0&&$domElement.is(":visible")){$domElement.prop("disabled",true)}window.vBulletin.loadingIndicator.show("vBulletin.ckeditor.showLoadingDialog editorId: "+editorId)};vBulletin.ckeditor.hideLoadingDialog=function(editorId){if((typeof vBulletin.ckeditor.loadingDialogStack[editorId]=="undefined")||!vBulletin.ckeditor.loadingDialogStack[editorId]){return }vBulletin.ckeditor.loadingDialogStack[editorId]=false;$("#"+editorId).prop("disabled",false);window.vBulletin.loadingIndicator.hide("vBulletin.ckeditor.hideLoadingDialog editorId: "+editorId)};vBulletin.ckeditor.generatedIdCounter=0;vBulletin.ckeditor.verifyEditorId=function(editorId){editorId=editorId||"";if(typeof editorId=="string"){return editorId}else{var $el=editorId instanceof $?editorId:$(editorId);if(!$el.attr("id")){++vBulletin.ckeditor.generatedIdCounter;$el.attr("id",("vb-cke-instance-"+vBulletin.ckeditor.generatedIdCounter))}return $el.attr("id")}};vBulletin.ckeditor.initEditorComponents=function(context,ckeditorOnly){context=context||document;$(function(){$(".js-ckeditor-init-on-focus",context).off("focus").on("focus",function(){vBulletin.ckeditor.initEditor($(this))});$(".js-ckeditor-init-on-page-load",context).each(function(){vBulletin.ckeditor.initEditor($(this))});if(ckeditorOnly){return }(function(){var getIconUrl=function(iconId){return $(".js-content-entry-post-icons option",context).filter(function(){return($(this).val()==iconId)}).data("icon-url")};var getIconElement=function(iconId){if(iconId==0){return $("<span />").html(vBulletin.phrase.get("no_icon")).get(0)}var iconUrl=getIconUrl(iconId);if(iconUrl){return $("<img />").attr("src",iconUrl).attr("alt","").get(0)}else{return""}};$(".js-content-entry-post-icons",context).selectBox().change(function(){var iconId=$(this).val();$(".js-content-entry-post-icons.selectBox-dropdown .selectBox-label",context).html(getIconElement(iconId))});$(".js-content-entry-post-icons-selectBox-dropdown-menu li a",context).each(function(){var iconId=$(this).attr("rel");$(this).html(getIconElement(iconId))});$(".js-content-entry-post-icons",context).trigger("change")})();$(".js-content-entry-prefixes",context).selectBox()})};vBulletin.ckeditor.initEditorComponents(document);$(".js-focus-on-page-load").first().focus();vBulletin.AJAX=function(ajaxOptions){var defaultOptions={type:"post",dataType:"json",error_phrase:"error",element:null,error:function(xhr,statusText,error){openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get(this.error_phrase,error),iconType:"error"})}};$.extend(defaultOptions,ajaxOptions);defaultOptions.success=function(response){if(response&&response.errors){var error=response.errors;if($.isArray(error)&&error.length>0){error=error[0]}if(error=="inlinemodauth_required"){return vBulletin.inlinemod.openAuthDialog(defaultOptions.element)}openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("error_x",vBulletin.phrase.get(error)),iconType:"error"});if(response.wasNotArray){arguments[0]=arguments[0][0]}return false}else{if(ajaxOptions.success){ajaxOptions.success.apply(this,arguments)}}};$.ajax(defaultOptions)};vBulletin.ajaxForm=function(ajaxOptions){var defaultOptions={dataType:"json",error_phrase:"error",element:null,error:function(xhr,statusText,error){console.log("Error {0}: {1}".format(xhr.status,error));openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get(this.error_phrase),iconType:"error"})},complete:function(){$(".button[type=submit]",this).prop("disabled",false)},beforeSerialize:function($form){$(".placeholder",$form).each(function(){var $input=$(this);if($input.val()==$input.attr("placeholder")){$input.val("")}})},beforeSubmit:function(formData,form,options){$(".button[type=submit]",this).prop("disabled",true);return true}};$.extend(defaultOptions,ajaxOptions);defaultOptions.success=function(response){if(response&&response.errors){var error=response.errors;if($.isArray(error)&&error.length>0){error=error[0]}if(error=="inlinemodauth_required"){return vBulletin.inlinemod.openAuthDialog(defaultOptions.element)}openAlertDialog({title:vBulletin.phrase.get("error"),message:vBulletin.phrase.get("error_x",vBulletin.phrase.get(error)),iconType:"error"});if(response.wasNotArray){arguments[0]=arguments[0][0]}return false}else{if(ajaxOptions.success){ajaxOptions.success.apply(this,arguments)}}};this.ajaxForm(defaultOptions)};window.openAlertDialog=function(params){var $alertDialog=$("#alert-dialog");params=params||{};if(!$alertDialog.data("created")){$alertDialog.dialog({autoOpen:false,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,dialogClass:"dialog-container alert-dialog-container dialog-box",create:function(){$alertDialog.data("created",true)}})}$alertDialog.dialog("option","width",params.width||500);$alertDialog.dialog("option","title",params.title||"Alert");var $dialogContent=$alertDialog.find(".dialog-content");var $message=$dialogContent.find(".message");var $icon=$dialogContent.find(".icon");var $okButton=$("#btnAlertDialogOK");if(params.maxHeight){$dialogContent.css({"max-height":params.maxHeight,overflow:"auto"})}else{$dialogContent.css({"max-height":"",overflow:""})}if(params.message){$message.html(params.message)}$icon.removeClass(function(index,css){return(css.match(/\S+-icon\b/g)||[]).join(" ")});params.buttonLabel=params.buttonLabel||"OK";$okButton.html(params.buttonLabel);$alertDialog.off("dialogopen").on("dialogopen",function(){$okButton.off("click").on("click",function(){if(typeof params.onBeforeClose=="function"){params.onBeforeClose.apply(this)}$alertDialog.dialog("close")}).focus()});$alertDialog.off("dialogclose").on("dialogclose",function(){if(typeof params.onAfterClose=="function"){params.onAfterClose.apply($okButton)}});switch(params.iconType){case"warning":$icon.addClass("warning-icon vb-icon vb-icon-warning");$icon.show();break;case"error":$icon.addClass("error-icon vb-icon vb-icon-error");$icon.show();break;default:$icon.addClass("no-icon").hide()}$alertDialog.dialog("open");return $alertDialog};window.openConfirmDialog=function(params){params=params||{};var $confirmDialog=$("#confirm-dialog");if(!$confirmDialog.data("created")){$confirmDialog.dialog({autoOpen:false,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,create:function(){$confirmDialog.data("created",true)}})}$confirmDialog.dialog("option","title",params.title||"Confirmation");var $dialogContent=$confirmDialog.find(".dialog-content");var $message=$dialogContent.find(".message");var $icon=$dialogContent.find(".icon");if(params.message){$message.html(params.message)}$confirmDialog.dialog("option","width",(params.width?params.width:500));$confirmDialog.dialog("option","dialogClass","dialog-container confirm-dialog-container dialog-box "+(params.dialogClass||""));$icon.removeClass(function(index,css){return(css.match(/\S+-icon\b/g)||[]).join(" ")});params.buttonLabel=params.buttonLabel||{};params.buttonLabel.yesLabel=params.buttonLabel.yesLabel||vBulletin.phrase.get("yes");params.buttonLabel.noLabel=params.buttonLabel.noLabel||vBulletin.phrase.get("no");var yesButton=$("#btnConfirmDialogYes").html(params.buttonLabel.yesLabel);var noButton=$("#btnConfirmDialogNo").html(params.buttonLabel.noLabel);if(params.primaryButton=="yes"){yesButton.addClass("primary").removeClass("secondary");noButton.addClass("secondary").removeClass("primary")}else{noButton.addClass("primary").removeClass("secondary");yesButton.addClass("secondary").removeClass("primary")}var btn;$confirmDialog.off("dialogopen").on("dialogopen",function(){var yesButton=$("#btnConfirmDialogYes").off("click").on("click",function(){btn=this;var retYes,retClose;if(typeof params.onClickYes=="function"){retYes=params.onClickYes.apply(this);if(typeof params.onClickYesWithAjax!="undefined"&&params.onClickYesWithAjax){return false}}if(retYes===false){return false}if(typeof params.onBeforeClose=="function"){retClose=params.onBeforeClose.apply(this);if(typeof params.onBeforeCloseWithAjax!="undefined"&&params.onBeforeCloseWithAjax){return false}}if(retClose===false){return false}$confirmDialog.dialog("close")});if(params.defaultFocus=="yes"){yesButton.focus()}var noButton=$("#btnConfirmDialogNo").off("click").on("click",function(){btn=this;if(typeof params.onClickNo=="function"){params.onClickNo.apply(this)}if(typeof params.onBeforeClose=="function"){params.onBeforeClose.apply(this)}$confirmDialog.dialog("close")});if(params.defaultFocus!="yes"){noButton.focus()}});$confirmDialog.off("dialogclose").on("dialogclose",function(e,ui){if(typeof params.onAfterClose=="function"){params.onAfterClose.apply(btn)}});switch(params.iconType){case"warning":$icon.addClass("warning-icon vb-icon vb-icon-warning");$icon.show();break;case"question":$icon.addClass("question-icon");$icon.show();break;default:$icon.addClass("no-icon").hide()}$confirmDialog.dialog("open");return $confirmDialog};window.openPromptDialog=function(params){var $promptDialog=$("#prompt-dialog");if(!$promptDialog.data("created")){$promptDialog.dialog({autoOpen:false,modal:true,resizable:false,closeOnEscape:false,showCloseButton:false,width:500,dialogClass:"dialog-container prompt-dialog-container dialog-box",create:function(){$promptDialog.data("created",true)}})}params=params||{};$promptDialog.dialog("option","title",params.title||"Prompt");var $dialogContent=$promptDialog.find(".dialog-content");var $message=$dialogContent.find(".message");var $input;if(params.message){$message.html(params.message)}var inputVal=params.initialValue||"";if(!params.multiline){$input=$promptDialog.find("input.input-box").val(inputVal).removeClass("h-hide");$input.next().addClass("h-hide");if(Number(params.maxlength)){$input.attr("maxlength",Number(params.maxlength))}else{$input.removeAttr("maxlength")}$dialogContent.addClass("table");$dialogContent.find("> div").addClass("td")}else{$input=$promptDialog.find("textarea.input-box").val(inputVal).removeClass("h-hide");$input.prev().addClass("h-hide");$dialogContent.removeClass("table");$dialogContent.find("> .td").removeClass("td")}params.buttonLabel=params.buttonLabel||{};params.buttonLabel.okLabel=params.buttonLabel.okLabel||"OK";params.buttonLabel.cancelLabel=params.buttonLabel.cancelLabel||"Cancel";var okButton=$("#btnPromptDialogOK").html(params.buttonLabel.okLabel);var cancelButton=$("#btnPromptDialogCancel").html(params.buttonLabel.cancelLabel);var btn;$promptDialog.off("dialogopen").on("dialogopen",function(){var okButton=$("#btnPromptDialogOK").off("click").on("click",function(){btn=this;var inputValue=$.trim($input.val()),retClose,retYes;if(params.validation&&typeof params.validation=="object"){if(params.validation.override&&typeof params.validation.custom=="function"){if(!params.validation.custom.apply(this,[$input])){return false}}else{switch(params.validation.type){case"number":inputValue=Number(inputValue);if(isNaN(inputValue)){if(params.validation.showError){openAlertDialog({title:$promptDialog.dialog("option","title"),message:"Input must be a number.",iconType:"warning",onAfterClose:function(){$input.trigger("select").trigger("focus")}})}else{$input.trigger("select").trigger("focus")}return false}if(params.validation.range&&typeof params.validation.range=="object"){if(inputValue<params.validation.range.min||inputValue>params.validation.range.max){if(params.validation.showError){openAlertDialog({title:$promptDialog.dialog("option","title"),message:"Input must be within "+params.validation.range.min+" - "+params.validation.range.max+" only.",iconType:"warning",onAfterClose:function(){$input.trigger("select").trigger("focus")}})}else{$input.trigger("select").trigger("focus")}return false}}break;case"string":default:if(!inputValue){if(params.validation.showError){openAlertDialog({title:$promptDialog.dialog("option","title"),message:"Input required.",iconType:"warning",onAfterClose:function(){$input.trigger("select").trigger("focus")}})}else{$input.trigger("select").trigger("focus")}return false}else{if(params.multiline&&inputValue.length>params.maxlength){if(params.validation.showError){openAlertDialog({title:$promptDialog.dialog("option","title"),message:"Input too long. Maximum allowed is "+params.maxlength+" characters.",iconType:"warning",onAfterClose:function(){$input.trigger("select").trigger("focus")}})}else{$input.trigger("select").trigger("focus")}return false}}}if(params.validation.set&&$.isArray(params.validation.set)&&params.validation.set.length>0){if($.inArray(inputValue,params.validation.set)==-1){if(params.validation.showError){openAlertDialog({title:$promptDialog.dialog("option","title"),message:"Input must be one of these: "+params.validation.set.join(", ")+".",iconType:"warning",onAfterClose:function(){$input.trigger("select").trigger("focus")}})}else{$input.trigger("select").trigger("focus")}return false}}if(typeof params.validation.custom=="function"){if(!params.validation.custom.apply(this,[$input])){return false}}}}if(typeof params.onClickOK=="function"){retYes=params.onClickOK.apply(this,[inputValue]);if(typeof params.onClickOKWithAjax!="undefined"&&params.onClickOKWithAjax){return false}}if(retYes===false){return false}if(typeof params.onBeforeClose=="function"){retClose=params.onBeforeClose.apply(this);if(typeof params.onBeforeCloseWithAjax!="undefined"&&params.onBeforeCloseWithAjax){return false}}if(retClose===false){return false}$promptDialog.dialog("close")}).trigger("focus");var cancelButton=$("#btnPromptDialogCancel").off("click").on("click",function(){btn=this;if(typeof params.onClickCancel=="function"){params.onClickCancel.apply(this)}if(typeof params.onBeforeClose=="function"){params.onBeforeClose.apply(this)}$promptDialog.dialog("close")})});$promptDialog.off("dialogclose").on("dialogclose",function(){if(typeof params.onAfterClose=="function"){params.onAfterClose.apply(btn);$input.val("")}});$promptDialog.dialog("open");$input.trigger("focus");return $promptDialog};window.openLoadingDialog=function(){console.warn("Function openLoadingDialog is deprecated.");window.vBulletin.loadingIndicator.show("openLoadingDialog")};window.closeLoadingDialog=function(){console.warn("Function closeLoadingDialog is deprecated.");window.vBulletin.loadingIndicator.hide("closeLoadingDialog")};window.bindFormReset=function(formSelector){return $(formSelector).on("reset",function(e,callback){if(typeof callback=="function"){callback()}})};setTimeout(function(){if(!$.support.selectstart){$.fn.extend({disableSelection:function(){return this.each(function(){$(this).css({"-moz-user-select":"-moz-none","-webkit-user-select":"none","-khtml-user-select":"none","-o-user-select":"none","user-select":"none"})})},enableSelection:function(){return this.each(function(){$(this).css({"-moz-user-select":"","-webkit-user-select":"","-khtml-user-select":"","-o-user-select":"","user-select":""})})}})}function initPage(){window.vBulletin.loadingIndicator.init();var loadSiteBuilderStyle=function(){$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/render/stylesheet_block",data:{"cssFiles[]":["sitebuilder-after.css"]},type:"POST",dataType:"json",success:function(response){$("head").append(response)}})};$(document).off("click","a.animate-scroll").on("click","a.animate-scroll",function(){var check=vBulletin.scrollToAnchor(this.hash);if(check){window.location.href=this.href}return false});var splitButtonClickHandler=function(e){$(this).closest(".split-button").toggleClass("open").find(".submenu").toggleClass("h-hide");$("body").off("click.buttonset").on("click.buttonset",function(e){if($(e.target).closest(".split-button").length==0){$(".split-button").removeClass("open").find(".submenu").addClass("h-hide");$("body").off("click.buttonset")}})};$(".split-button .button-text").button().closest(".button-set").find(".button-icon").button({text:false,icons:{primary:"vb-icon vb-icon-triangle-down-wide"}}).on("click",splitButtonClickHandler).closest(".button-set").buttonset().filter(".one-click").find(".button-text").on("click",splitButtonClickHandler);$(document).off("click",".canvas-widget .toggle-button").on("click",".canvas-widget .toggle-button",function(e,noAnimation){var $btn=$(this),$canvasWidget=$btn.closest(".canvas-widget");if($btn.hasClass("expand")){if(noAnimation){$(".widget-content",$canvasWidget).show()}else{$(".widget-content",$canvasWidget).slideDown("slow")}$canvasWidget.removeClass("collapsed")}else{if(noAnimation){$(".widget-content",$canvasWidget).hide()}else{$(".widget-content",$canvasWidget).slideUp("slow")}$canvasWidget.addClass("collapsed")}$btn.toggleClass("collapse expand");var currentTooltip=$btn.attr("title");$btn.attr("title",$btn.data("toggle-title")).data("toggle-title",currentTooltip);return false});$(".conversation-toolbar-wrapper form.toolbar-filter-overlay").trigger("reset");var nativePlaceholderSupported=!!("placeholder" in document.createElement("input"));if(!nativePlaceholderSupported){var $placeholderFields=$("input[placeholder], textarea[placeholder]");$placeholderFields.filter(":focus").addClass("js-temp-focus").blur();$placeholderFields.placeholder();var setFocusBack=function(removeFocusClass){var $focusedField=$placeholderFields.filter(".js-temp-focus").focus();if(removeFocusClass){$focusedField.removeClass("js-temp-focus")}};$(window).on("load.placeholder_temp",function(){setFocusBack(true);$(window).off("load.placeholder_temp")});setFocusBack()}if($("textarea.autogrow").length>0){$("textarea.autogrow").elastic().off("blur.elastic")}$(".edit-switch-container .switch-control").on("mousedown",function(e){var $self=$(this);if($self.closest("ul").hasClass("h-disabled")){return true}if($self.hasClass("on")){$.removeCookie(pageData.sb_state_cookie,{path:pageData.baseurl_path});$("#main-navbar .main-nav").hide();$self.removeClass("on");return true}loadSiteBuilderStyle();if($("#main-navbar .main-nav li").length>0){$("#main-navbar .main-nav").show();$self.addClass("on");$.cookie(pageData.sb_state_cookie,"1",{path:pageData.baseurl_path});return true}loadSitebuilderMarkup(true);return true});$("select.custom-dropdown").selectBox();$(document).off("keypress",".js-button").on("keypress",".js-button",function(e){if(e.which==32||e.which==13){if(e.target&&e.target.nodeName&&(e.target.nodeName+"").toLowerCase()=="label"&&$(e.target).find("input").length==1){$(e.target).find("input").trigger("click")}else{$(this).trigger("click")}e.preventDefault()}});$(document).off("keypress",".js-link").on("keypress",".js-link",function(e){if(e.which==13){$(this).trigger("click");e.preventDefault()}});var $contentEntryBox=$(".content-entry-box:not(.content-entry-box-Media):has(.content-entry-box-tabs)");$(".content-entry-box-tab",$contentEntryBox).removeClass("ui-state-disabled");$contentEntryBox.tabs({show:function(event,ui){if($contentEntryBox.length==1){var editorId=$(ui.tab.hash).find('textarea[name="text"]').attr("id");if($("#"+editorId).is(":visible")&&($(".content-entry-box").closest("#quick-reply-container").length==0||$(".content-entry-box").closest("#quick-reply-container").data("allow-ckeditor-load-on-show"))){vBulletin.ckeditor.initEditor(editorId,{complete:function(ckeditorId){console.log("enabling all tabs...");$contentEntryBox.tabs("option","disabled",[]);$(window).off("error.editorInit")},error:function(ckeditorId){$("#"+ckeditorId).prop("disabled",false).removeClass("ckeditor-load-on-focus").closest(".content-entry-box").addClass("no-ckeditor");var $contentEntryBox=$(ui.tab).closest(".content-entry-box");var $editorTab=$(".editor-tab",$contentEntryBox);if($editorTab.length>0&&$editorTab[0]==$(ui.tab).parent()[0]){$contentEntryBox.tabs("select",0)}}})}else{if($(".content-entry-box").closest("#quick-reply-container").length==1){$(ui.tab.hash).find(".ckeditor-bare-box.ckeditor-load-on-focus").on("focus",function(){vBulletin.ckeditor.initEditor(editorId,{complete:function(ckeditorId){console.log("enabling all tabs...");$contentEntryBox.tabs("option","disabled",[]);$(window).off("error.editorInit")},error:function(ckeditorId){$("#"+ckeditorId).prop("disabled",false).removeClass("ckeditor-load-on-focus").closest(".content-entry-box").addClass("no-ckeditor");var $contentEntryBox=$(ui.tab).closest(".content-entry-box");var $editorTab=$(".editor-tab",$contentEntryBox);if($editorTab.length>0&&$editorTab[0]==$(ui.tab).parent()[0]){$contentEntryBox.tabs("select",0)}}})})}}$(".content-entry-box").closest("#quick-reply-container").data("allow-ckeditor-load-on-show",true);vBulletin.hv.initHvForPostAction($(ui.panel))}$("html").trigger("click")},select:function(event,ui){var indices=[],tabsLen=$(this).tabs("length");for(var i=0;i<tabsLen;i++){if(i!=ui.index){indices.push(i)}}$(window).off("error.editorInit").on("error.editorInit",function(){$contentEntryBox.tabs("option","disabled",[]);$(this).off("error.editorInit");return true});console.log("disabling tabs..."+indices);$(this).tabs("option","disabled",indices);$("html").trigger("click")}});$contentEntryBox.find("input[type=text]").off("keydown").on("keydown",function(e){if(e.which==13){e.preventDefault();return false}return true});$(".mainmenu li:has(.submenu)").on("click",function(e){$(".submenu",this).show();return false}).hover(function(){},function(e){$(".submenu",this).hide()});$(".mainmenu.textControls li").on("click",function(e){if($(".tagCtrl",this).length==0){$("#tag-dialog").hide()}});$(".mainmenu .submenu li a").on("click",function(e){$(this).closest(".submenu").hide()});$(".follow-btn").on("click",function(e){if(!$(this).hasClass("isSubscribed")){vBulletin.subscribe(this)}else{if($(this).hasClass("unfollow-btn")){if($(this).hasClass("is-blog-channel")){vBulletin.leave(this)}else{vBulletin.unsubscribe(this)}}}});$(".follow-btn").on("mouseover",function(e){if($(this).hasClass("isSubscribed")&&!$(this).hasClass("is-owner")){$(this).addClass("unfollow-btn secondary").removeClass("special");var text=vBulletin.phrase.get("following_remove");$(this).children(".button-text-primary").text(text)}});$(".follow-btn").on("mouseout",function(e){if($(this).hasClass("unfollow-btn")){$(this).removeClass("unfollow-btn secondary").addClass("special");var text=vBulletin.phrase.get("following");$(this).children(".button-text-primary").text(text)}});$(".share-btn").on("click",function(e){alert("Not yet implemented");return false});$(".join-btn").on("click",function(e){if(!$(this).hasClass("has-joined")&&!$(this).hasClass("is-pending")){vBulletin.join(this)}else{if($(this).hasClass("leave-btn")&&!$(this).hasClass("is-owner")){vBulletin.leave(this)}}});$(".join-btn").on("mouseover",function(e){if($(this).hasClass("has-joined")&&!$(this).hasClass("is-owner")){$(this).addClass("leave-btn secondary").removeClass("special");var text=vBulletin.phrase.get("leave");$(this).children(".button-text-primary").text(text)}});$(".join-btn").on("mouseout",function(e){if($(this).hasClass("leave-btn")&&!$(this).hasClass("is-owner")){$(this).removeClass("leave-btn secondary").addClass("special");var text=vBulletin.phrase.get("joined");$(this).children(".button-text-primary").text(text)}});$(".channel-content-widget .new-conversation-btn").off("click").on("click",function(){window.location.href=pageData.baseurl+"/new-content/"+pageData.channelid});$(".pagenav-form").submit(function(){if(Number(this.page.value)>0){location.href=this.action+"&p="+this.page.value}return false}).trigger("reset");$(".toolbar-pagenav").off("keydown",".toolbar-pagenav input").on("keydown",".toolbar-pagenav input",function(e){var key=e.which;if(!e.shiftKey&&!e.altKey&&!e.ctrlKey&&((key>=48&&key<=57)||(key>=96&&key<=105)||key==8||key==9||key==13||key==35||key==36||key==37||key==39||key==46||key==45)){return true}return false});$(document).off("click",".list-item.deleted .manage-controls .manage").on("click",".list-item.deleted .manage-controls .manage",function(){vBulletin.inlinemod.manage_deleted_form.apply(this)});$(document).off("click",".list-item.deleted .manage-controls .show-hide").on("click",".list-item.deleted .manage-controls .show-hide",function(){var $self=$(this),origText=$self.text(),toggleText=$self.data("toggle-text");if($self.hasClass("control-show")){$self.closest(".list-item").addClass("show-deleted-content");$self.html(toggleText).data("toggle-text",origText).removeClass("control-show")}else{$self.closest(".list-item").removeClass("show-deleted-content");$self.html(toggleText).data("toggle-text",origText).addClass("control-show")}});$(".js-tooltip[title]").qtip({style:{classes:"ui-tooltip-shadow ui-tooltip-light"}});$.datepicker.regional.vb={monthNames:[vBulletin.phrase.get("january"),vBulletin.phrase.get("february"),vBulletin.phrase.get("march"),vBulletin.phrase.get("april"),vBulletin.phrase.get("may"),vBulletin.phrase.get("june"),vBulletin.phrase.get("july"),vBulletin.phrase.get("august"),vBulletin.phrase.get("september"),vBulletin.phrase.get("october"),vBulletin.phrase.get("november"),vBulletin.phrase.get("december")],dayNamesMin:[vBulletin.phrase.get("sunday_min"),vBulletin.phrase.get("monday_min"),vBulletin.phrase.get("tuesday_min"),vBulletin.phrase.get("wednesday_min"),vBulletin.phrase.get("thursday_min"),vBulletin.phrase.get("friday_min"),vBulletin.phrase.get("saturday_min")]};$.datepicker.setDefaults($.datepicker.regional.vb);$.timepicker.regional.vb={timeText:vBulletin.phrase.get("time"),currentText:vBulletin.phrase.get("now"),closeText:vBulletin.phrase.get("done"),hourText:vBulletin.phrase.get("hour"),minuteText:vBulletin.phrase.get("minute")};$.timepicker.setDefaults($.timepicker.regional.vb);$(".js-datepicker").not(".hasDatePicker").datetimepicker({showOn:"both",buttonImage:pageData.baseurl+"/images/calendar-blue.png",buttonImageOnly:true,ampm:true});$(document).off("click","a.video-frame").on("click","a.video-frame",function(e){e.preventDefault();var data={code:this.getAttribute("data-vcode"),provider:this.getAttribute("data-vprovider")};if(this.getAttribute("data-height")){data.height=this.getAttribute("data-height")}if(this.getAttribute("data-width")){data.width=this.getAttribute("data-width")}var videocontainer=$(this);$.get(vBulletin.getAjaxBaseurl()+"/ajax/render/bbcode_video",data,function(template){if(template){videocontainer.replaceWith(template)}},"json")});vBulletin.conversation.showPostLink=function(e){var self=$(this);if(this.tagName.toLowerCase()=="span"){self=self.parent()}self.qtip({content:{title:{text:vBulletin.phrase.get("share_post_link_help"),button:true},text:'<input type="text" class="textbox stretch" value="'+self.attr("href")+'" />'},position:{my:"right top",at:"left top",viewport:$(window)},show:{event:"click",solo:true},events:{show:function(event,api){},visible:function(event,api){api.elements.content.find("input.textbox").focus().select()},hide:function(event,api){}},hide:{event:"unfocus",fixed:true},style:{classes:"ui-tooltip-shadow ui-tooltip-light ui-tooltip-sharepostlink"}});self.qtip("api").show()};if($(".js-content-entry-tag-editor").length>0&&vBulletin.tagEditor){new vBulletin.tagEditor.instance(".js-content-entry-tag-editor")}vBulletin.markreadcheck();$(document).off("click","a.markchannelsread, a.navbar_mark_channels_read").on("click","a.markchannelsread, a.navbar_mark_channels_read",function(){vBulletin.markchannelsread(0,{success:function(){location.reload()},failed:function(){openAlertDialog({title:vBulletin.phrase.get("forum"),message:"Mark Channels Read failed: {0}".format(result),iconType:"error"})}},$(this));return false})}function replaceSecurityToken(){window.clearTimeout(securitytoken_timeout);if(pageData.securitytoken!="guest"){var securitytoken_timeout=window.setTimeout(replaceSecurityToken,3600000);$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/replace-securitytoken",data:{securitytoken:pageData.securitytoken},type:"POST",dataType:"json",success:function(result){if(result&&!result.error){var securitytoken_errors=0;doReplaceSecurityToken(result.newtoken)}else{console.log("/ajax/replace-securitytoken, error: "+error);if(++securitytoken_errors==3){doReplaceSecurityToken("guest")}}},error:function(xhr,statusText,error){console.log("/ajax/replace-securitytoken, error: "+error);if(++securitytoken_errors==3){doReplaceSecurityToken("guest")}}})}}function doReplaceSecurityToken(newtoken){if(newtoken==""){return }$("form").each(function(){var frm=$(this);if(typeof (this.method)!="undefined"&&this.method.toLowerCase()=="post"){if(frm.find('input[name="securitytoken"]').length){frm.find('input[name="securitytoken"]').val(newtoken)}else{frm.append('<input type="hidden" name="securitytoken" value="'+newtoken+'" />')}}});pageData.securitytoken=newtoken;console.log("Securitytoken updated")}function afterInit(){if(vBulletin.options.get("crontab")){if(pageData.nextcron<=pageData.current_server_datetime){vBulletin.loadingIndicator.suppressNextAjaxIndicator();$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/cron/run",type:"POST",dataType:"json",success:function(result){if(result&&result.errors){console.warn("Cron error: "+vBulletin.phrase.get(result.errors[0][0]))}console.log("Cron run successfully.")},error:function(xhr,statusText,error){console.warn("Error when running cron: {0}".format(error))}})}else{}}}function loadSitebuilderMarkup(noLoadingDialog){$("body").css("cursor","wait");if(!noLoadingDialog){window.vBulletin.loadingIndicator.show()}$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/activate-sitebuilder",data:({pageid:pageData.pageid,nodeid:pageData.nodeid}),type:"POST",dataType:"json",cache:false,complete:function(){console.log("activate-sitebuilder complete.");$("body").css("cursor","auto");if(!noLoadingDialog){window.vBulletin.loadingIndicator.hide()}},success:function(result){console.log("activate-sitebuilder successful! result:"+JSON.stringify(result));if(result&&result.menu&&result.template){$(".edit-switch-container .switch-control").addClass("on");$("#main-navbar .main-nav").hide().html(result.menu);$("#sitebuilder-wrapper").html(result.template);$("#main-navbar .main-nav").show();$.cookie(pageData.sb_state_cookie,"1",{path:pageData.baseurl_path})}else{console.log("activating sitebuilder failed!");openAlertDialog({title:"Error",message:"Error activating SiteBuilder.<br /><br />Please try again.",iconType:"error"})}},error:function(xhr,statusText,error){console.log("activating sitebuilder failed! error:"+error);openAlertDialog({title:"Error",message:"Error activating SiteBuilder. (Error code {0})<br /><br />Please try again.".format(xhr.status),iconType:"error"})}})}initPage();$("#searchPopupControl").on("click",function(e){if($(this).hasClass("open")){$(this).removeClass("open");$("#searchPopupContent").hide()}else{$(this).addClass("open");$("#searchPopupContent").show()}});$("html").on("click",function(e){if($(e.target).closest("#searchForm").size()==0&&$("#searchPopupControl").hasClass("open")){$("#searchPopupControl").removeClass("open");$("#searchPopupContent").hide()}});$("#btnAdvSearch").off("click").on("click",function(e){e.preventDefault();$(this).data("clicked2submit",1);var $searchForm=$("#searchForm");$searchForm.attr("action",$searchForm.attr("action")+"&AdvSearch=1");$("#searchForm").submit()});$("#searchForm").off("submit.searchform").on("submit.searchform",function(e){var searchJSON={};var searchFields_keywords=$("#q");if($.trim(searchFields_keywords.val()).length>0){searchJSON.keywords=$.trim(searchFields_keywords.val())}else{if(!$("#btnAdvSearch").data("clicked2submit")){openAlertDialog({title:vBulletin.phrase.get("search"),message:vBulletin.phrase.get("please_provide_search_string"),iconType:"warning",onAfterClose:function(){$("#searchForm #q").focus()}});e.stopPropagation();return false}}var container=$(this).find("#searchPopupContent");var searchFields_title_only=container.find(".searchFields_title_only");if(searchFields_title_only.size()>0&&searchFields_title_only.prop("checked")){searchJSON.title_only=1}var searchFields_author=container.find(".searchFields_author");if(searchFields_author.size()>0&&searchFields_author.prop("checked")){searchJSON.author=[searchFields_author.val()]}var searchFields_channel=container.find(".searchFields_channel");if(searchFields_channel.size()>0&&searchFields_channel.prop("checked")){searchJSON.channel=[searchFields_channel.val()]}container.find("input[name=searchJSON]").val(JSON.stringify(searchJSON));return true});$(".history-backbutton").off("click").on("click",function(e){history.back()});$(".popupControl[popup-body]").off("click").on("click",function(e){var popupBodyClass=$(this).attr("popup-body");if(!popupBodyClass){return false}var popupBody=$(this).parent().find("."+popupBodyClass);if(!popupBody){return false}$(popupBody).toggleClass("h-hide")});var np_notices_displayed;if(!(np_notices_displayed=$.cookie(pageData.cookie_prefix+"np_notices_displayed"))){np_notices_displayed=new Array()}if(!(np_notices_displayed instanceof Array)){np_notices_displayed=new Array(np_notices_displayed)}$('ul.notices li[data-notice-persistent="0"]').each(function(index){np_notices_displayed.push($(this).attr("data-notice-id"))});if(np_notices_displayed.length>0){$.cookie(pageData.cookie_prefix+"np_notices_displayed",np_notices_displayed,{path:pageData.baseurl_path})}else{$.cookie(pageData.cookie_prefix+"np_notices_displayed",null,{path:pageData.baseurl_path})}$("ul.notices > li > .close").off("click").on("click",function(e){var noticeli=$(this).closest("li"),noticeid=noticeli.attr("data-notice-id");$("body").css("cursor","wait");$.ajax({url:vBulletin.getAjaxBaseurl()+"/ajax/api/notice/dismiss",data:{noticeid:noticeid},type:"POST",dataType:"json",complete:function(){$("body").css("cursor","auto")},success:function(result){if(result&&!result.error){console.log("Notice dismissed successfully!");noticeli.hide("slow",function(){if($(this).parent().find(">li:visible").length==0){$(this).parent().addClass("h-hide")}})}},error:function(xhr,statusText,error){console.log("Notice dismissed failed! error:"+error);openAlertDialog({title:"Error",message:"Error dismissing the notice.",iconType:"error"})}})});$("#frmActivateuser").ajaxForm({dataType:"json",beforeSubmit:function(formData,form,options){var error="",focusfield="";if($.trim($(".username",form).val())==""){error=vBulletin.phrase.get("please_enter_a_username");focusfield=".username"}else{if($.trim($(".activateid",form).val())==""){error=vBulletin.phrase.get("requiredfieldmissing",vBulletin.phrase.get("activation_code"));focusfield=".activateid"}}if(error){openAlertDialog({title:vBulletin.phrase.get("error"),message:error,iconType:"warning",onAfterClose:function(){$(focusfield,form).focus()}});return false}return true},success:function(response,statusText,xhr,$form){if(response&&response.response&&response.response.errors){var errors=[];for(var x in response.response.errors){if(response.response.errors[x][0]!="exception_trace"&&response.response.errors[x][0]!="errormsg"){errors.push(vBulletin.phrase.get(response.response.errors[x]))}}openAlertDialog({title:vBulletin.phrase.get("error"),message:errors.join("<br />"),iconType:"warning",onAfterClose:function(){vBulletin.hv.reset(true)}})}else{var messagephraseparams=response.response.msg_params;messagephraseparams.unshift(response.response.msg);openAlertDialog({title:vBulletin.phrase.get("activate_your_account"),message:vBulletin.phrase.get.apply(vBulletin.phrase,messagephraseparams),onAfterClose:function(){window.location.href=pageData.baseurl}})}}});$("#frmActivateemail").ajaxForm({dataType:"json",beforeSubmit:function(formData,form,options){var error="",focusfield="";if($.trim($(".email",form).val())==""){error=vBulletin.phrase.get("please_enter_your_email_address")}else{if(!isValidEmailAddress($(".email",form).val())){error=vBulletin.phrase.get("invalid_email_address")}}if(error){openAlertDialog({title:vBulletin.phrase.get("error"),message:error,iconType:"warning",onAfterClose:function(){$(focusfield,form).focus()}});return false}return true},success:function(response,statusText,xhr,$form){if(response&&response.response&&response.response.errors){var errors=[];for(var x in response.response.errors){if(response.response.errors[x][0]!="exception_trace"&&response.response.errors[x][0]!="errormsg"){errors.push(vBulletin.phrase.get(response.response.errors[x]))}}openAlertDialog({title:vBulletin.phrase.get("error"),message:errors.join("<br />"),iconType:"warning",onAfterClose:function(){vBulletin.hv.reset(true)}})}else{var messagephraseparams=response.response.msg_params;messagephraseparams.unshift(response.response.msg);openAlertDialog({title:vBulletin.phrase.get("email_activation_codes"),message:vBulletin.phrase.get.apply(vBulletin.phrase,messagephraseparams),onAfterClose:function(){window.location.href=pageData.baseurl}})}}});var styleid=$.cookie(pageData.cookie_prefix+"userstyleid");if(styleid){$(".stylechooser").val(styleid)}$(".stylechooser").change(function(){var styleid=$("option:selected",$(this)).val();var expiredate=new Date();expiredate.setDate(expiredate.getDate()+365);$.cookie(pageData.cookie_prefix+"userstyleid",styleid,{path:pageData.baseurl_path,expires:expiredate});window.location.reload()});var languageid=$.cookie(pageData.cookie_prefix+"languageid");if(languageid){$(".languagechooser").val(languageid)}$(".languagechooser").change(function(){var languageid=$("option:selected",$(this)).val();var expiredate=new Date();expiredate.setDate(expiredate.getDate()+365);$.cookie(pageData.cookie_prefix+"languageid",languageid,{path:pageData.baseurl_path,expires:expiredate});window.location.reload()});$("a.navbar_profile").on("click",function(){if(pageData.userid=="0"){$("#lnkLoginSignupMenu").click();return false}});doReplaceSecurityToken(pageData.securitytoken);var securitytoken_timeout=window.setTimeout(replaceSecurityToken,3600000);var securitytoken_errors=0;if(!vBulletin.ckeditor.checkEnvironment()){$(".b-content-entry").find("li[data-panel=b-content-entry-panel__content--toggle-editor]").addClass("h-hide")}setTimeout(afterInit,5)},1);vBulletin.getQueryString=function(a){if(a==""){return{}}var b={};for(var i=0;i<a.length;++i){var p=a[i].split("=");if(p.length!=2){continue}b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "))}return b};vBulletin.triggerHandler=function(eventName,$parent,extraParams){if(!$parent||$parent.length==0){$parent=$(document)}else{if(!($parent instanceof $)){$parent=$($parent)}}extraParams=extraParams||[];var event=$.Event(eventName);event.target=this instanceof $?this.get(0):this;return $parent.triggerHandler(event,extraParams)}})(jQuery);function JShtmlEncode(B){var A="";if(B&&typeof B!=="undefined"&&B.length>0){A=$("<div/>").text(B).html()}return A}function showPhotoDialog(A){$("#gallery_dialog"+A).dialog()}function displayPositionedPopup(E){if(E.dialog){E.dialog=$(E.dialog)}if(!E.dialog||E.dialog.size()==0){E.dialog=$("<div />").html('<h3><label class="h-left">'+E.title+'</label><label class="h-right btnClose">x</label><div class="h-clear"></div></h3><div class="content"></div><div class="arrow"><div class="arrowOver"></div></div>').addClass("custom-dialog").css("z-index",1100).appendTo(document.body);if(E.className){E.dialog.addClass(E.className)}if(E.width){E.dialog.css("width",E.width)}if(typeof E.id=="string"){E.dialog.prop("id",E.id)}E.dialog.find(".btnClose").on("click",function(){E.dialog.fadeOut();return false})}if(E.content){if(typeof E.content=="string"){E.dialog.find(".content").html(E.content);if(typeof E.loaded=="function"){E.loaded(E)}E.dialog.show()}else{if(typeof E.content=="function"){E.dialog.find(".content").html('<span class="text">Loading...</span><span class="loading-icon"><img width="16" height="16" alt="" src="'+pageData.baseurl+'/images/ajax-loader.gif"></span>');E.dialog.show();window.setTimeout(function(){E.content(E)},1)}}}var A=$("#wrapper").offset();var D=$("#wrapper").outerWidth();var N=$(E.target).offset();var K=$(E.target).outerWidth();var I=$(E.target).outerHeight();var F=E.dialog.outerWidth();var M=E.dialog.find(".arrow");var H=M.outerWidth();var L=M.outerHeight();var C=F-M.position().left-H;var B=N.left+(K/2)-F+C+(H/2)-2;if(B<A.left){var G=parseInt(M.css("right"));M.css("left",G);C=G+H;B=N.left+(K/2)-C+(H/2)-2}var J=N.top+I+L;E.dialog.css({left:B,top:J});if(typeof E.ready=="function"){E.ready(E)}}function closePhotoDialog(A){$("#gallery_dialog"+A).close()}function isValidEmailAddress(B){var A=new RegExp(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/i);return A.test(B)}function str_repeat(D,C){var B="";for(var A=0;A<C;A++){B=B.concat(D)}return B}function showStatusMessage(A,F){var C=$(".conversation-status-message.notice"),E;if(C.length>0){var B=C.filter("."+F);if(B.length==1){C=B}else{if((E=C.filter(".h-hide")).length==1){C=E}else{C=C.first().clone().removeClass().addClass("conversation-status-message notice").appendTo(".conversation-status-messages")}}C=(B.length==1?B:C).show();if(!vBulletin.isScrolledIntoView(C)){var D=C.offset().top-10;C.hide();$("html,body").animate({scrollTop:D},"slow",function(){C.find("span").html(A).end().addClass(F+" show-x").fadeIn("slow","linear")})}else{if(C.hasClass("h-hide")){C.hide().removeClass("h-hide").addClass(F+" show-x").find("span").html(A).end().fadeIn(800,"linear")}else{C.fadeOut("slow","linear",function(){C.find("span").html(A).end().addClass(F+" show-x").fadeIn("slow","linear")})}}}}window.vBulletin.htmlEntities=function(A){return String(A).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'"'/g,"&quot;")};window.vBulletin.htmlEntities_decode=function(A){return String(A).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')};window.vBulletin.loadedIds=window.vBulletin.loadedIds||[];window.vBulletin.isAlreadyLoaded=function(A){if($.inArray(A,window.vBulletin.loadedIds)!=-1){return true}window.vBulletin.loadedIds.push(A)};